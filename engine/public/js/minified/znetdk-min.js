/*!
 * ZnetDK, Starter Web Application for rapid & easy development
 * See official website http://www.znetdk.fr/
 * Copyright (C) 2023 Pascal MARTINEZ (contact@znetdk.fr)
 * License GNU GPL http://www.gnu.org/licenses/gpl-3.0.html GNU GPL
 * --------------------------------------------------------------------
 * ZnetDK JS library
 * File version: 3.1.0
 */var znetdk={requestContext:[],ajaxInProgress:0,request:function(options){var $this=this,ajaxURL=this.getParamsFromAjaxURL(znetdkAjaxURL);if(options.control&&options.action){var ajaxOptions={type:"POST",url:ajaxURL.url,success:function(response){try{if(options.htmlTarget){options.htmlTarget.prepend(response);var innerForm=options.htmlTarget.find('form.zdk-form').last(),functionToCallback=typeof options.callback==="function",waitUntilFormIsReady=!options.htmlTarget.is('body')&&innerForm.length>0&&functionToCallback;if(waitUntilFormIsReady){innerForm.one('zdkformready',function(){options.callback(response)})}
$this.autoInitWidgets(options.htmlTarget);if(functionToCallback&&!waitUntilFormIsReady){options.callback(response)}}else if(typeof response==="object"){if(typeof options.callback==="function"){options.callback(response)}else{var levelMsg=response.success===!1?'error':response.warning===!0?'warn':'info',summary=response.summary===undefined?'Message':response.summary;$this.message(levelMsg,summary,response.msg)}}else{$this.message('error','Message','Invalid Ajax response sent by the web server!')}}catch(err){console.error('ZnetDK - JS error detected on AJAX request',options,err);$('body').trigger('zdkrequestcallbackjserror',{ajaxContext:options,jsError:err})}},error:function(response){var isDisconnected,errorMsg,errorSummary,appVersion,reloadSummary,reloadMsg,errorLevel=response.status===401?'warn':'critical';if(/application\/json/.test(response.getResponseHeader('Content-Type'))){try{let errorObject=JSON.parse(response.responseText);isDisconnected=errorObject.is_disconnected;errorMsg=errorObject.msg;errorSummary=errorObject.summary;appVersion=errorObject.appver;reloadSummary=errorObject.reload_summary;reloadMsg=errorObject.reload_msg}catch(e){}}
if(response.status===0){let msgArray=$('#zdk-network-error-msg').html().split("|");errorSummary=msgArray[0];errorMsg=msgArray[1];errorLevel='error'}else if(errorMsg===undefined){errorMsg="The JSON response returned by the controller='"+options.control+"' and the action='"+options.action+"' can't be parsed! HTTP status: "+response.status+' '+response.statusText;errorSummary='Error parsing server response'}
$this.message(errorLevel,errorSummary,errorMsg);if(response.status===401&&isDisconnected===!1){if(typeof appVersion==='number'&&typeof reloadSummary==='string'&&typeof reloadMsg==='string'&&parseInt($('body').data('appver'))<appVersion){reloadApp(reloadSummary,reloadMsg)}else{$this.requestContext.push(options);if($this.requestContext.length===1){$this.showLoginDialog()}}}else if(response.status===401&&isDisconnected===!0){reloadApp(errorSummary,errorMsg)}}};if(options.data&&typeof options.data==="object"){let requestData;if(options.data.length===undefined){let property;requestData='control='+options.control+'&action='+options.action;for(property in options.data){var value=options.data[property],encodedValue=typeof value==='string'?encodeURIComponent(value):value;if(value!==undefined&&value!==null){requestData+='&'+property+'='+encodedValue}}}else{requestData='control='+options.control+'&action='+options.action+'&'+$.param(options.data)}
if(ajaxURL.paramName!==undefined){requestData+='&'+ajaxURL.paramName+'='+ajaxURL.paramValue}
ajaxOptions.data=requestData}else if(options.fileToUpload&&typeof options.fileToUpload==="object"){let formData=new FormData();formData.append('control',options.control);formData.append('action',options.action);if(ajaxURL.paramName!==undefined){formData.append(ajaxURL.paramName,ajaxURL.paramValue)}
if(options.fileToUpload.inputName!==undefined&&options.fileToUpload.file!==undefined){formData.append(options.fileToUpload.inputName,options.fileToUpload.file,options.fileToUpload.file.name);ajaxOptions.data=formData;ajaxOptions.processData=!1;ajaxOptions.contentType=!1}else{throw new Error("znetdk.request: 'fileToUpload' option is not properly set!")}}else{ajaxOptions.data={control:options.control,action:options.action};if(ajaxURL.paramName!==undefined){ajaxOptions.data[ajaxURL.paramName]=ajaxURL.paramValue}}
const token=$('body').data('ui-token');if(token&&token.length>0){if(ajaxOptions.data instanceof FormData){ajaxOptions.data.append('uitk',token)}else if(typeof ajaxOptions.data==='string'){ajaxOptions.data+='&uitk='+token}else if(typeof ajaxOptions.data==='object'){ajaxOptions.data.uitk=token}}
return $.ajax(ajaxOptions)}else{console.log("Call to znetdk.request failed : ",options.control,options.action)}
function reloadApp(summary,msg){znetdk.notifyUser({title:summary,message:msg,buttonLabel:'Ok',callback:function(){$(window).off('beforeunload').off('unload');location.reload()}})}},loadView:function(options){if(options.htmlTarget.length){znetdk.request(options)}},showModalDialog:function(dialogId,viewName,beforeShow,afterShow){var callbackFunction=function(){if(typeof afterShow==="function"){$('#'+dialogId).one('zdkmodalaftershow',function(){afterShow($(this))})}
var isToDisplay=!0;if(typeof beforeShow==="function"){isToDisplay=beforeShow($('#'+dialogId))!==!1}
if(isToDisplay){$('#'+dialogId).zdkmodal('show')}};if($('#'+dialogId).length===0){znetdk.loadView({control:viewName,action:'show',htmlTarget:$('body'),callback:callbackFunction})}else{callbackFunction()}},requestFromQueue:function(){var queueSize=this.requestContext.length;for(index=0;index<queueSize;index++){this.request(this.requestContext[index])}
this.requestContext.splice(0,queueSize)},getCurrentLanguage:function(){var currentLanguage=$('html').attr('lang');if(currentLanguage){return currentLanguage}else{return''}},getParamsFromAjaxURL:function(){var URLArray=znetdkAjaxURL.split("?"),paramArray=[],result=new Object();result.url=URLArray[0];if(URLArray.length===2){paramArray=URLArray[1].split("=");result.paramName=paramArray[0];result.paramValue=paramArray[1]}
return result},autoInitWidgets:function(parentElement){if(parentElement instanceof jQuery&&parentElement.length){var forms=parentElement.find('.zdk-form');parentElement.find('.zdk-modal').zdkmodal();forms.zdkform();parentElement.find('.zdk-datatable:not(.zdk-nocreate)').zdkdatatable();parentElement.find('.zdk-action-bar').zdkactionbar()}},initCommonWidgets:function(parentElement){if(parentElement instanceof jQuery&&parentElement.length){var inputRowsElement=parentElement.find('.zdk-inputrows');if(inputRowsElement.length>0){try{inputRowsElement.zdkinputrows()}catch(exception){console.error("znetdk.initCommonWidgets: the 'zdkinputrows' widget does not exist!")}}
parentElement.find(':text,:password,input[type="email"],input[type="number"],'+'input[type="url"],input[type="time"], input[type="search"]').not('.zdk-autocomplete').puiinputtext();parentElement.find('input[type="text"].zdk-autocomplete,'+'input[type="search"].zdk-autocomplete').zdkautocomplete();parentElement.find('input[type="date"]').zdkinputdate({regional:znetdk.getCurrentLanguage()});parentElement.find('input[type="file"]').zdkinputfile();parentElement.find('div.zdk-inputhtml').zdkinputhtml();parentElement.find('div.zdk-multiupload').zdkmultiupload();parentElement.find('textarea').puiinputtextarea();parentElement.find('button.zdk-bt-yes').puibutton({icon:'fa-check'});parentElement.find('button.zdk-bt-no').puibutton({icon:'fa-close'});parentElement.find('button.zdk-bt-add').puibutton({icon:'fa-plus-circle'});parentElement.find('button.zdk-bt-edit').puibutton({icon:'fa-pencil'});parentElement.find('button.zdk-bt-remove').puibutton({icon:'fa-minus-circle'});parentElement.find('button.zdk-bt-cancel').puibutton({icon:'fa-close'});parentElement.find('button.zdk-bt-save').puibutton({icon:'fa-save'});parentElement.find('button.zdk-bt-reset').puibutton({icon:'fa-eraser'});parentElement.find('button.zdk-bt-search').puibutton({icon:'fa-search'});parentElement.find('button.zdk-bt-clear').puibutton({icon:'fa-times-rectangle'});parentElement.find('button.zdk-bt-refresh').puibutton({icon:'fa-refresh'});parentElement.find('button.zdk-bt-download').puibutton({icon:'fa-download'});parentElement.find('button.zdk-bt-upload').puibutton({icon:'fa-upload'});parentElement.find('button.zdk-bt-custom').each(function(){var iconAttr=znetdk.getTextFromAttr($(this),'data-zdk-icon'),options={};if(iconAttr){var attrArray=iconAttr.split(":");options.icon=attrArray[0];options.iconPos=attrArray.length===2?attrArray[1]:'left'}
$(this).puibutton(options)});parentElement.find(':checkbox').puicheckbox();parentElement.find('.zdk-radiobuttongroup').zdkradiobuttongroup();parentElement.find(':radio').puiradiobutton();parentElement.find('fieldset').puifieldset();parentElement.find('select.zdk-listbox').zdklistbox();parentElement.find('select.zdk-dropdown').zdkdropdown();parentElement.find('div.zdk-picklist').zdkpicklist()}},message:function(severity,summary,detail){if(severity==='critical'){var htmlMessage='<span class="pui-growl-image zdk-image-fatal" />'+'<h3>'+summary+'</h3><p>'+detail+'</p>';$('#zdk-critical-err').puinotify('show',htmlMessage)}else{$('#zdk-messages').puigrowl('show',[{severity:severity,summary:summary,detail:detail}])}},multiMessages:function(messages){$('#zdk-messages').puigrowl('show',messages)},showMenuView:function(viewName,options){$('#zdk-classic-menu').zdktabmenu('selectTab',viewName);$('#zdk-office-menu').zdkofficemenu('openWindow',viewName,options);$('#zdk-custom-menu').zdkgenericmenu('displayView',viewName)},getUserConfirmation:function(options){var dialogID='znetdk_confirmation_dialog';var dialogElement=$('#'+dialogID);if(dialogElement.length){dialogElement.remove()}
$('body').append('<div id="'+dialogID+'"/>');dialogElement=$('#'+dialogID);dialogElement.attr('title',options.title);dialogElement.append('<div class="zdk-image-question"></div>');dialogElement.append('<p class="zdk-text-question">'+options.message+'</p>');dialogElement.append('<div class="ui-helper-clearfix"/>');dialogElement.append('<div class="pui-dialog-buttonpane ui-widget-content ui-helper-clearfix"/>');dialogElement.find('.pui-dialog-buttonpane').append('<button class="zdk-bt-yes" type="button"/>');dialogElement.find('.pui-dialog-buttonpane').append('<button class="zdk-bt-no" type="button"/>');var buttonYesElement=dialogElement.find('.pui-dialog-buttonpane > button.zdk-bt-yes');var buttonNoElement=dialogElement.find('.pui-dialog-buttonpane > button.zdk-bt-no');buttonYesElement.text(options.yesLabel);buttonNoElement.text(options.noLabel);buttonYesElement.puibutton({icon:'fa-check'}).click(function(){dialogElement.puidialog('hide');if(typeof options.callback==="function"){options.callback(!0)}});buttonNoElement.puibutton({icon:'fa-close'}).click(function(){dialogElement.puidialog('hide');if(typeof options.callback==="function"){options.callback(!1)}});dialogElement.puidialog({resizable:!1,showEffect:'fade',hideEffect:'fade',minimizable:!1,maximizable:!1,closeOnEscape:!1,closable:!1,modal:!0,width:350,visible:!0});if(options.focusOnYes===!0){buttonYesElement.focus()}else{buttonNoElement.focus()}},notifyUser:function(options){var dialogID='znetdk_confirmation_dialog';var dialogElement=$('#'+dialogID);if(dialogElement.length){dialogElement.remove()}
$('body').append('<div id="'+dialogID+'"/>');dialogElement=$('#'+dialogID);dialogElement.attr('title',options.title);dialogElement.append('<div class="zdk-image-question"></div>');dialogElement.append('<p class="zdk-text-notification">'+options.message+'</p>');dialogElement.append('<div class="ui-helper-clearfix"/>');dialogElement.append('<div class="pui-dialog-buttonpane ui-widget-content ui-helper-clearfix"/>');dialogElement.find('.pui-dialog-buttonpane').append('<button class="zdk-bt-yes" type="button"/>');var buttonYesElement=dialogElement.find('.pui-dialog-buttonpane > button.zdk-bt-yes');buttonYesElement.text(typeof options.buttonLabel==='string'?options.buttonLabel:'Ok');buttonYesElement.puibutton({icon:'fa-check'}).click(function(){dialogElement.puidialog('hide');if(typeof options.callback==="function"){options.callback()}});dialogElement.puidialog({resizable:!1,showEffect:'fade',hideEffect:'fade',minimizable:!1,maximizable:!1,closeOnEscape:!1,closable:!1,modal:!0,width:350,visible:!0})},useStyleSheet:function(styleSheetFile){var cssLink=$("<link rel='stylesheet' type='text/css' href='"+styleSheetFile+"'>");$("head").append(cssLink)},useScriptFile:function(scriptFile){var jsLink=$("<script type='text/javascript' src='"+scriptFile+"'>");$("head").append(jsLink)},showFinalMessage:function(message){$('#zdk-classic-menu').remove();$('#zdk-office-menu').remove();$('#zdk-custom-menu').remove();$('#zdk-win-container').remove();$('#zdk-login-dialog').remove();$('.zdk-modal').remove();$('.ui-widget-overlay').remove();$('#zdk-content').empty();$("#zdk-connection-area").addClass("ui-helper-hidden-accessible");$("#zdk-help-area").addClass("ui-helper-hidden-accessible");$("#zdk-language-area").addClass("ui-helper-hidden-accessible");$("#zdk-breadcrumb-text").addClass("ui-helper-hidden-accessible");$("#zdk-navi-toolbar").addClass("ui-helper-hidden-accessible");$('#default_content').removeClass("ui-helper-hidden");$("#default_content").html(message);znetdk.setFooterSticky(!0);$('body').trigger('disconnected')},addLabelToTitle:function(label){var separator=" | ";var newTitle=document.title;var sepIndex=newTitle.indexOf(separator);if(sepIndex===-1){newTitle=label===null||label===""?newTitle:label+separator+newTitle}else{newTitle=label===null||label===""?newTitle.substring(sepIndex+separator.length):label+separator+newTitle.substring(sepIndex+separator.length)}
document.title=newTitle},showLoginDialog:function(changepwd){var changePwdValue=changepwd!==undefined&&changepwd?!0:!1,applyOption=function(){$('#zdk-login-dialog').zdklogindialog('option','changepwd',changePwdValue)};if($('#zdk-login-dialog').length){applyOption();$('#zdk-login-dialog').zdklogindialog('show')}else{$('body').append('<div id="zdk-login-dialog" />');var defaultLoginName=$('#zdk-connection-area').attr('data-zdk-login');$('#zdk-login-dialog').zdklogindialog({loginName:defaultLoginName});applyOption();$('#zdk-login-dialog').bind("zdklogindialogcancel",function(event,response){znetdk.showFinalMessage(response.msg);$('#zdk-login-dialog').zdklogindialog('hide')});$('#zdk-login-dialog').bind("zdklogindialogsuccess",function(event,response){$('#zdk-login-dialog').zdklogindialog('hide');if(znetdk.isMenuExists()){znetdk.requestFromQueue()}else{location.reload()}})}},getSelectedMenu:function(){var selectedMenu=null;if($('#zdk-classic-menu').length){selectedMenu=$('#zdk-classic-menu').zdktabmenu('getSelectedTab')}else if($('#zdk-office-menu').length){selectedMenu=$('#zdk-office-menu').zdkofficemenu('getSelectedMenuItem')}else if($('#zdk-custom-menu').length){selectedMenu=$('#zdk-custom-menu').zdkgenericmenu('getSelectedMenuItem')}
return selectedMenu},goToPageAnchor:function(){var pageURL=document.URL;var sepIndex=pageURL.lastIndexOf('#');if(sepIndex!==-1){var anchor=pageURL.substring(sepIndex);var tempLink=$('<a href="'+anchor+'"></a>').appendTo('body');tempLink[0].click();tempLink.remove()}},initLanguageSelect:function(){var selectCountryEl=$('#zdk-language-area select');if(selectCountryEl.length===1){const countries=selectCountryEl.data('countries'),currentLang=selectCountryEl.data('curlang'),rootUri=(znetdk.getParamsFromAjaxURL()).url.replace('index.php','');selectCountryEl.puidropdown({data:countries,content:function(option){return'<img id="zdk-language-area-img" src="'+rootUri+option.icon+'" alt="'+option.label+'" /><span id="zdk-language-area-label">'+option.label+'</span>'},change:function(){var selected_lang=$(this).val();if(selected_lang!==currentLang){$('#zdk-language-area > form').submit()}}}).puidropdown('selectValue',currentLang)}},initNavigationMenu:function(){$('#zdk-classic-menu').zdktabmenu({pageReload:znetdk.isPageToBeReloaded()});$('#zdk-office-menu').zdkofficemenu();$('#zdk-custom-menu').zdkgenericmenu({htmlTarget:$("#zdk-content")})},isMenuExists:function(){return Boolean($('#zdk-classic-menu').length||$('#zdk-office-menu').length||$('#zdk-custom-menu').length)},isAuthenticationRequired:function(){var isDefaultContentHidden=$('#default_content').hasClass("ui-helper-hidden");return(!znetdk.isMenuExists()&&isDefaultContentHidden)},isPageToBeReloaded:function(){return($('#zdk-classic-menu').hasClass('zdk-pagereload')||$('#zdk-office-menu').hasClass('zdk-pagereload')||$('#zdk-custom-menu').hasClass('zdk-pagereload'))},getElementFromAttr:function(attribElement,attribute){var attribText=attribElement.attr(attribute);if(attribText!==undefined){var element=$('#'+attribText);if(element.length){return element}else{return!1}}else{return!1}},getTextFromAttr:function(attribElement,attribute){var attribText=attribElement.attr(attribute);if(attribText!==undefined){return attribText}else{return!1}},getActionFromAttr:function(attribElement){var actionAttrib=attribElement.attr('data-zdk-action');if(actionAttrib!==undefined){var actionArray=actionAttrib.split(":");var result=new Object();result.controller=actionArray[0];result.action=actionArray[1];return result}else{return!1}},getLocalSettingsKeyPath:function(){var params=znetdk.getParamsFromAjaxURL(znetdkAjaxURL),url=params.url.replace('index.php','');if(params.hasOwnProperty('paramName')&&params.paramName==='appl'&&params.hasOwnProperty('paramValue')){url+=params.paramValue+'/'}
return url},getLocalSettings:function(storageKey){var url=this.getLocalSettingsKeyPath();try{var storedValue=localStorage.getItem(url+storageKey);if(storedValue){return storedValue}else{storedValue=localStorage.getItem(storageKey);if(storedValue){return storedValue}
return!1}}catch(e){console.log("ZnetDK 'api.js': local storage not supported by the browser!");return!1}},storeLocalSettings:function(storageKey,value){var url=this.getLocalSettingsKeyPath();try{localStorage.setItem(url+storageKey,value);return!0}catch(e){console.log("ZnetDK 'api.js': local storage not supported by the browser!");return!1}},setFooterSticky:function(fixed){if($("#zdk-footer").hasClass('zdk-sticky')){var isFixed=fixed===undefined?!1:fixed;if(isFixed){$('#zdk-footer').css({'position':'fixed','bottom':'0'})}else{var minHeightContent,pageHeight=$(window).height(),contentPosition=$("#zdk-content").offset(),contentExtraHeight=$("#zdk-content").css(["borderTopWidth","marginTop","paddingTop"]),footerHeight=$("#zdk-footer").outerHeight(!0);minHeightContent=pageHeight-footerHeight-contentPosition.top-1;minHeightContent-=parseFloat(contentExtraHeight.borderTopWidth)+parseFloat(contentExtraHeight.marginTop)+parseFloat(contentExtraHeight.paddingTop);$("#zdk-content").css('min-height',minHeightContent+'px')}}},registerServiceWorker:function(){var appUrl=(znetdk.getParamsFromAjaxURL()).url.replace('index.php',''),scriptUrl=$('body').data('service-worker-url'),fullUrl=appUrl+scriptUrl;if(typeof scriptUrl==='undefined'||scriptUrl.length===0){return!1}
if('serviceWorker' in navigator){navigator.serviceWorker.register(fullUrl).then(undefined,function(error){console.error("'"+fullUrl+"': "+error.message);return!1})}else{console.warn('Service workers are not supported.');return!1}
return!0},reducePhotoSize:function(photoAsFile,maxWidth,maxHeight,callback){var img=new Image();img.src=window.URL.createObjectURL(photoAsFile);img.onload=function(){var MAX_WIDTH=maxWidth;var MAX_HEIGHT=maxHeight;var width=img.width;var height=img.height;if(width>MAX_WIDTH){height=height*(MAX_WIDTH/width);width=MAX_WIDTH}
if(height>MAX_HEIGHT){width=width*(MAX_HEIGHT/height);height=MAX_HEIGHT}
var canvas=document.createElement("canvas");canvas.width=width;canvas.height=height;var ctx=canvas.getContext("2d");ctx.drawImage(img,0,0,width,height);try{canvas.toBlob(function(reducedImageAsBlob){var reducedImageAsFile=null;if(reducedImageAsBlob!==null){reducedImageAsFile=new File([reducedImageAsBlob],photoAsFile.name,{lastModified:photoAsFile.lastModifiedDate,type:reducedImageAsBlob.type})}
callback(reducedImageAsFile)},'image/jpeg')}catch(err){console.log('miePhotoTools.reduceSize: conversion to BLOB failed.');callback(null)}
window.URL.revokeObjectURL(this.src)}},reducePhotoSizePercent:function(photoAsFile,percent,minWidthHeight,callback){if(!photoAsFile.type.startsWith("image/")||typeof percent!=='number'||typeof minWidthHeight!=='number'||percent>100||percent<0||minWidthHeight<1){callback(null);return!1}
if(percent===100){callback(photoAsFile);return!0}
var img=new Image();img.src=window.URL.createObjectURL(photoAsFile);img.onload=function(){const maxWidthHeight=Math.max(img.width,img.height),newSize=percent>0?maxWidthHeight*percent/100:minWidthHeight;window.URL.revokeObjectURL(this.src);if(newSize<minWidthHeight||(percent===0&&minWidthHeight>maxWidthHeight)){callback(photoAsFile)}else{znetdk.reducePhotoSize(photoAsFile,newSize,newSize,callback)}};return!0}};$.widget("znetdk.zdkactionbar",{options:{dialogID:null,datatableID:null,whenadd:null,whenedit:null,whenremove:null,getRemoveConfirm:null},_create:function(){this._setOptionsFromAttr();this.element.children('button').wrapAll("<div class='zdk-buttons' />").each(function(){$(this).get(0).type='text'});this.selectRows=this.element.children('select.zdk-select-rows').first();if(this.selectRows.length){this.selectRows.attr('style','width:70px;').removeClass('zdk-select-rows');this.selectRows.wrap('<div class="zdk-select-rows"></div>');var selectRowsLabel=this.selectRows.attr('title');if(selectRowsLabel!==undefined){this.selectRows.before('<div class="zdk-select-rows-label">'+selectRowsLabel+'</div>')}
var selectedOption=this._getDefaultNumberOfSelectedRows();this.selectRows.find('option[value='+selectedOption+']').first().prop('selected',!0);this.selectRows.puidropdown()}
var filterRows=this.element.children('div.zdk-filter-rows').first();if(filterRows.length){this.filterSearch=filterRows.children('.zdk-bt-search').first();this.filterClear=filterRows.children('.zdk-bt-clear').first();this.filterClear.get(0).type='button';this.filterSearch.get(0).type='submit';this.filterAutoComplete=filterRows.children('input').first();this.filterAutoComplete.add(this.filterClear).add(this.filterSearch).wrapAll('<form/>');this.filterForm=filterRows.children('form');this.filterAutoComplete.each(function(){var elementTitle=$(this).attr('title');if(elementTitle!==undefined){$(this).attr("placeholder",elementTitle);$(this).removeAttr('title')}
$(this).get(0).type='text';$(this).attr("autocomplete","off");var options={effect:'fade',effectSpeed:'fast'},delay=znetdk.getTextFromAttr($(this),'data-zdk-delay');if(delay!==!1){options.delay=delay}
$(this).puiautocomplete(options)})}
this.element.after('<div class="ui-helper-clearfix"/>');znetdk.initCommonWidgets(this.element);this._emptySearchField();this._bindEvents()},_bindEvents:function(){var $this=this;var addButton=this.element.find('button.zdk-bt-add');if(addButton.length&&this.options.dialogID){addButton.click(function(){var dialogTitle=addButton.attr('title');if(dialogTitle===undefined){dialogTitle=addButton.text()}
$this._getDialog().find('span.pui-dialog-title').text(dialogTitle);$this._getDialog().find('form').zdkform('reset');$this._showDialogAfterSynchronization("whenadd")})}
var editButton=this.element.find('button.zdk-bt-edit');if(editButton.length&&this.options.dialogID&&this.options.datatableID){editButton.click(function(){var datatableSelection=$this._getSelectedRowInDatatable();if(datatableSelection!==!1){$this.editRow(datatableSelection)}else{var noSelectionMsg=znetdk.getTextFromAttr(editButton,'data-zdk-noselection');if(noSelectionMsg!==!1){znetdk.message('warn',$this._getEditDialogTitle(),noSelectionMsg)}}})}
this.removeButton=this.element.find('button.zdk-bt-remove');if(this.removeButton.length&&this.options.datatableID){this._on(this.removeButton,{"click":function(){var datatableSelection=$this._getSelectedRowInDatatable();var dialogTitle=$this.removeButton.attr('title');if(dialogTitle===undefined){dialogTitle=$this.removeButton.text()}
if(datatableSelection!==!1){if($this._trigger("whenremove")===!1){return};var confirmationMsg=znetdk.getTextFromAttr($this.removeButton,'data-zdk-confirm');var idName=$this._getRowIdParamName();if(confirmationMsg!==!1){var msgArray=confirmationMsg.split(":");znetdk.getUserConfirmation({title:dialogTitle,message:msgArray[0],yesLabel:msgArray[1],noLabel:msgArray[2],callback:function(confirmation){if(confirmation){$this._removeRow(datatableSelection[idName],idName)}}})}else if(typeof $this.options.getRemoveConfirm==="function"){$this.options.getRemoveConfirm.call($this,$this._removeRow,datatableSelection[idName],idName,dialogTitle)}else{$this._removeRow(datatableSelection[idName],idName)}}else{var noSelectionMsg=znetdk.getTextFromAttr($this.removeButton,'data-zdk-noselection');if(noSelectionMsg!==!1){znetdk.message('warn',dialogTitle,noSelectionMsg)}}}})}
var refreshButton=this.element.find('button.zdk-bt-refresh');if(refreshButton.length&&this.options.datatableID){refreshButton.click(function(){$this._refreshDatatable(!0)})}
if(this.selectRows.length&&this.options.datatableID){this.selectRows.puidropdown('option','change',function(){$this._getDatatable().zdkdatatable('setPaginator','rows',$(this).val());$this._refreshDatatable(!0);$this._storeDefaultNumberOfSelectedRows($(this).val())})}
if(this.filterAutoComplete!==undefined){if(this.filterAutoComplete.length&&this.options.datatableID){var ctrlAction=znetdk.getActionFromAttr(this.filterAutoComplete);this.filterAutoComplete.puiautocomplete('option','completeSource',function(request,response){var autoCompleteElement=this;znetdk.request({control:ctrlAction.controller,action:ctrlAction.action,data:{criteria:request.query},callback:function(data){response.call(autoCompleteElement,data)}})})}
if(this.filterSearch.length&&this.filterAutoComplete.length&&this.options.datatableID){this.filterForm.submit(function(event){var filterValue=$this.filterAutoComplete.val();if(filterValue===''){var noValueMsg=znetdk.getTextFromAttr($this.filterSearch,'data-zdk-novalue');if(noValueMsg!==!1){znetdk.message('warn',$this.filterSearch.attr('title'),noValueMsg)}}else{if($this._trigger('search',event,{value:filterValue})){$this._getDatatable().zdkdatatable('filterRows',filterValue)}
if($this.filterClear.length){$this.filterClear.show();$this.filterAutoComplete.select()}}
event.preventDefault()})}
if(this.filterClear.length&&this.filterAutoComplete.length&&this.options.datatableID){this.filterClear.click(function(event){$this._emptySearchField();if($this._trigger('search',event,{value:null})){$this._getDatatable().zdkdatatable('filterRows',null)}
$this.filterAutoComplete.focus()})}}},editRow:function(row){var editButton=this.element.find('button.zdk-bt-edit');if(editButton.length===1&&this.options.dialogID&&this.options.datatableID){var dialogTitle=this._getEditDialogTitle();this._getDialog().find('form').zdkform('init',row);this._getDialog().find('span.pui-dialog-title').text(dialogTitle);this._showDialogAfterSynchronization("whenedit")}},_showDialogAfterSynchronization:function(eventName){var $this=this,synchronizedWidget=this._getDialog().find('.zdk-synchronize');if(synchronizedWidget.length===0){this._trigger(eventName);this._getDialog().zdkmodal("show",!0);return}
if(synchronizedWidget.hasClass('zdk-datatable')){synchronizedWidget.one("zdkdatatabledataloaded",function(){$this._getDialog().zdkmodal("show",!0)});this._trigger(eventName)}else if(synchronizedWidget.hasClass('zdk-inputrows')){synchronizedWidget.one("zdkinputrowsinitialized",function(){$this._getDialog().zdkmodal("show",!0)});this._trigger(eventName)}else{this._trigger(eventName);this._getDialog().zdkmodal("show",!0)}},_getEditDialogTitle:function(){var editButton=this.element.find('button.zdk-bt-edit');if(editButton.length===1){var dialogTitle=editButton.attr('title');if(dialogTitle===undefined){dialogTitle=editButton.text()}
return dialogTitle}else{return'No title!'}},_getDatatable:function(){return $('#'+this.options.datatableID)},_refreshDatatable:function(keepSelection){if(this.options.datatableID===null){return}
if(keepSelection===!0){this._getDatatable().zdkdatatable('option','keepSelectionOnId',this._getRowIdParamName())}else{this._getDatatable().zdkdatatable('option','keepSelectionOnId',null)}
this._getDatatable().zdkdatatable('refresh')},_getDialog:function(){return $('#'+this.options.dialogID)},_setOptionsFromAttr:function(){var datatableID=znetdk.getTextFromAttr(this.element,'data-zdk-datatable');if(datatableID!==!1){this.options.datatableID=datatableID}
var dialogID=znetdk.getTextFromAttr(this.element,'data-zdk-dialog');if(dialogID!==!1){this.options.dialogID=dialogID}},_getDefaultNumberOfSelectedRows:function(){var storageKeyPrefix='zdkdatatable_rows_',storageKey=storageKeyPrefix+this.options.datatableID,firstOptionValue=this.selectRows.find('option').first().val();if(storageKey===storageKeyPrefix){return firstOptionValue}
var storedValue=znetdk.getLocalSettings(storageKey);if(storedValue){return storedValue}else{return firstOptionValue}},_storeDefaultNumberOfSelectedRows:function(numberOfRows){var storageKeyPrefix='zdkdatatable_rows_',storageKey=storageKeyPrefix+this.options.datatableID;if(storageKey===storageKeyPrefix){return!1}
return znetdk.storeLocalSettings(storageKey,numberOfRows)},_getSelectedRowInDatatable:function(){if(this.options.datatableID){var selections=this._getDatatable().zdkdatatable('getSelection');if(selections.length===1&&selections[0]){return selections[0]}else{return!1}}else{return!1}},_removeRow:function(rowID,idName){var $this=this,ctrlAction=znetdk.getActionFromAttr(this.removeButton),row=new Object();row[idName]=rowID;znetdk.request({control:ctrlAction.controller,action:ctrlAction.action,data:row,callback:function(response){if(response.success){if($this.options.datatableID){$this._refreshDatatable()}
$this._trigger('rowremoved')}
if(response.summary&&response.msg){var levelMsg=response.success===!1?'error':response.warning===!0?'warn':'info';znetdk.message(levelMsg,response.summary,response.msg)}}})},_getRowIdParamName:function(){var idName='id',inputElement=this._getDialog().find('input.zdk-row-id');if(inputElement.length){var idNameFound=znetdk.getTextFromAttr(inputElement,'name');idName=idNameFound?idNameFound:idName}
return idName},_emptySearchField:function(){if(this.filterAutoComplete!==undefined){this.filterAutoComplete.val('')}
if(this.filterClear!==undefined){this.filterClear.hide()}}});$.widget("znetdk.zdkajaxloader",{_create:function(){this.loaderImageId="zdk-ajax-loading";this.loaderImagePath=this.element.attr('src');this.ajaxInProgress=0;this._bindEvents()},_bindEvents:function(){var $this=this;$(document).on("ajaxSend.zdkajaxloader",function(){if(!$this.ajaxInProgress){$this.setLoadingState()}
$this.ajaxInProgress+=1}).on("ajaxComplete.zdkajaxloader",function(){if($this.ajaxInProgress===1){$this.unsetLoadingState()}
$this.ajaxInProgress-=1});$(window).on('error.zdkajaxloader',function(event){$this.unsetLoadingState();if($this.ajaxInProgress>0){$this.ajaxInProgress-=1}})},setLoadingState:function(){$('body').block({message:null,overlayCSS:{backgroundColor:'#000',opacity:0},baseZ:3000});$('body').append('<img id="'+this.loaderImageId+'" src="'+this.loaderImagePath+'"/>')},unsetLoadingState:function(){$('body').unblock();$('#'+this.loaderImageId).remove()}});$(function(){$.widget("znetdk.zdkautocomplete",$.primeui.puiautocomplete,{options:{controller:null,action:null,criteria:null,autoWidth:!1,maxNumberOfCachedItems:0,cacheLifetime:'page'},_create:function(){this._setOptionsFromAttribute();this._setOptionCompleteSource();this.element.attr("autocomplete","off");this.suspended=!1;this.prevQueryString=null;this.itemCache=[];this._super()},_setOptionsFromAttribute:function(){var actionAttrib=znetdk.getActionFromAttr(this.element);if(actionAttrib!==!1){this.options.controller=actionAttrib.controller;this.options.action=actionAttrib.action}
var delay=znetdk.getTextFromAttr(this.element,'data-zdk-delay');if(delay!==!1){this.options.delay=delay}
var autoWidth=znetdk.getTextFromAttr(this.element,'data-zdk-autowidth');if(autoWidth!==!1){this.options.autoWidth=autoWidth==='true'}
var maxCachedItems=znetdk.getTextFromAttr(this.element,'data-zdk-maxcacheditems');if(maxCachedItems!==!1){this.options.maxNumberOfCachedItems=parseInt(maxCachedItems,10)}
var cacheLifetime=znetdk.getTextFromAttr(this.element,'data-zdk-cachelifetime');if(cacheLifetime!==!1){this.options.cacheLifetime=cacheLifetime}},_setOptionCompleteSource:function(){var $this=this;if(this.options.action!==undefined){this.options.completeSource=function(request,response){if($this.suspended){return!1}
if(!_isRequestRequired(request.query)){return}
if(_showCachedSuggestions(request.query,response)){return}
var requestData={query:request.query};if($this.options.criteria!==null){requestData.criteria=$this.options.criteria}
znetdk.request({control:$this.options.controller,action:$this.options.action,data:requestData,callback:function(data){response.call($this,data);if(data.length>0){_addToCacheData(data,request.query)}
_setPreviousQueryString(request.query,data.length)}})}}
function _setPreviousQueryString(queryString,responseCount){$this.prevQueryString={queryString:queryString,responseCount:responseCount}}
function _isRequestRequired(queryString){if($this.prevQueryString!==null&&$this.prevQueryString.responseCount===0&&queryString.indexOf($this.prevQueryString.queryString)>-1){return!1}
return!0}
function _showCachedSuggestions(queryString,responseCallback){for(let i=0;i<$this.itemCache.length;i++){if($this.itemCache[i].queryString===queryString){responseCallback.call($this,$this.itemCache[i].listOfItems);$this.element.off('zdkautocompleteselect.zdkautocomplete').one('zdkautocompleteselect.zdkautocomplete',function(){if($this.options.cacheLifetime==='selection'){$this.itemCache=[]}});return!0}}
return!1}
function _addToCacheData(response,queryString){if($this.itemCache.length>=$this.options.maxNumberOfCachedItems){$this.itemCache.shift()}
if($this.options.maxNumberOfCachedItems>0){$this.itemCache.push({queryString:queryString,listOfItems:response})}}},enable:function(){this.element.puiinputtext('enable')},disable:function(){this.element.puiinputtext('disable')},suspend:function(isSuspended){this.suspended=isSuspended},setCriteria:function(criteria){this.options.criteria=criteria},_alignPanel:function(){this._super();var leftPosition=parseInt(this.panel.css('left'));if(leftPosition<0){this.panel.css('left',0)}
if(this.options.autoWidth){this.panel.css('width','auto')}}})});$(function(){$.widget("primeui.puibutton",$.primeui.puibutton,{_create:function(){this._super();if(this.options.icon){var iconName=this.options.icon.split('-');if(iconName[0]==='fa'){this.element.children('span.ui-icon').removeClass('ui-icon').addClass('pui-icon fa fa-fw')}}}})});$(function(){$.widget("primeui.puicheckbox",$.primeui.puicheckbox,{enable:function(){if(this.box.hasClass('ui-state-disabled')){this._super()}},uncheck:function(silent){if(this.isChecked()){this.element.prop('checked',!1);this.box.removeClass('ui-state-active');this.icon.removeClass('ui-icon ui-icon-check');if(!silent){this.element.trigger('change')}}}})});$(function(){$.widget("znetdk.zdkdatatable",$.primeui.puidatatable,{options:{controller:null,action:null,selectionMode:'single',totalInCaption:!0,filterCriteria:null,keepSelectionOnId:null,resizableColumns:!1,resetSortLabel:null},_create:function(){this.element.addClass('zdk-datatable');this.lastSelection=null;this._setColumnsFromAttribute();this._setActionFromAttribute();this._setCaptionFromTitleAttribute();this._setPaginatorFromAttribute();this._setResizableColumnsFromAttribute();this._setMultipleSelectionFromAttribute();this._setResetSortLabelFromAttribute();this._getNumberOfPaginatorRowsFromLocalStorage();this._addHeaderAndBodyClasses();this._allowHtmlForColumns();if(this.options.controller&&this.options.action){this.options.lazy=!0;this.options.datasource=this._getRemoteDataSource()}
this._super()},_initSelection:function(){this._super();this._handleDoubleClickEvent()},_handleDoubleClickEvent:function(){var $this=this;$(document).off('dblclick.datatable',this.rowSelector).on('dblclick.datatable',this.rowSelector,null,function(event){if(!$(event.target).is(':input,:button,a')){var row=$(this),rowIndex=$this._getRowIndex(row),selectedData=$this.data[rowIndex],actionBarElement=$this.element.parent().find('div.zdk-action-bar[data-zdk-datatable='+$this.id+']');if(actionBarElement.length===1){actionBarElement.zdkactionbar('editRow',selectedData)}
$this._trigger("rowdblclicked",$this,selectedData)}})},_getRemoteDataSource:function(){return function(callback_function,ui){var $this=this,requestData={};if(ui.sortField&&ui.sortOrder){requestData.sortfield=ui.sortField;requestData.sortorder=ui.sortOrder;this._showHideResetSortButton(!0)}
if(this.options.paginator){var first=0,rows=this.options.paginator.rows;if(ui.first>=0&&ui.rows>=0){first=ui.first;rows=ui.rows}
requestData.first=first;requestData.rows=rows}
if(this.options.filterCriteria){requestData.search_criteria=this.options.filterCriteria}
znetdk.request({control:this.options.controller,action:this.options.action,data:requestData,callback:function(response){if(response.success===!0){if(response.total>=0){$this.setPaginator('totalRecords',parseInt(response.total));$this._setTotalInCaption(response.total)}
if(response.warning&&response.summary&&response.msg){znetdk.message('warn',response.summary,response.msg)}
callback_function.call($this,response.rows);$this._trigger('dataloaded',null);if($this.options.keepSelectionOnId!==null&&$this.options.keepSelectionOnId!==undefined&&$this.lastSelection!==undefined&&$this.lastSelection!==null){var selectedRowId=$this.lastSelection[$this.options.keepSelectionOnId];$this.selectRowById(selectedRowId,!1);$this.lastSelection=null}}else{znetdk.message('error',response.summary,response.msg)}}})}},_onLazyLoad:function(data){if(this.paginator!==undefined){this.paginator.puipaginator('refresh')}
this._super(data)},refresh:function(totalRecordsVariation){if(this.options.keepSelectionOnId!==null){this.lastSelection=this.getSelection().length===1?this.getSelection()[0]:null}
if(this.paginator){var totalVariation=totalRecordsVariation?totalRecordsVariation:0,totalRecords=this.paginator.puipaginator('option','totalRecords');totalRecords+=totalVariation;totalRecords=totalRecords>=0?totalRecords:0;this.setPaginator('totalRecords',totalRecords);this.paginator.puipaginator('refresh');this.paginate()}else{this._updateDatasource(this.options.datasource)}},filterRows:function(criteria){this.setPaginator('page',0);if(criteria){this.options.filterCriteria=criteria}else{this.options.filterCriteria=null}
this.paginate()},setPaginator:function(key,value){if(this.paginator){if(key==='page'){this.paginator.puipaginator('setPage',value,!0)}else{this.paginator.puipaginator('option',key,value)}}
if(this.options.paginator&&this.options.paginator.totalRecords>=0&&key==='totalRecords'){this.options.paginator.totalRecords=value}},_setColumnsFromAttribute:function(){var columnsAttrib=znetdk.getTextFromAttr(this.element,'data-zdk-columns');if(columnsAttrib!==!1){this.options.columns=$.parseJSON(columnsAttrib);this.element.removeAttr('data-zdk-columns')}},_setActionFromAttribute:function(){var actionAttrib=znetdk.getActionFromAttr(this.element);if(actionAttrib!==!1){this.options.controller=actionAttrib.controller;this.options.action=actionAttrib.action;this.element.removeAttr('data-zdk-action')}},_setCaptionFromTitleAttribute:function(){var titleAttrib=znetdk.getTextFromAttr(this.element,'title');if(titleAttrib!==!1){this.options.caption=titleAttrib;this.element.removeAttr('title')}},_setPaginatorFromAttribute:function(){var paginatorOptions=znetdk.getTextFromAttr(this.element,'data-zdk-paginator');if(paginatorOptions!==!1){var paginatorArray=paginatorOptions.split(":"),paginatorObject={};paginatorObject.rows=paginatorArray.length>0?parseInt(paginatorArray[0]):10;paginatorObject.totalRecords=0;paginatorObject.pageLinks=paginatorArray.length===2?parseInt(paginatorArray[1]):5;this.options.paginator=paginatorObject;this.element.removeAttr('data-zdk-paginator')}},_setResizableColumnsFromAttribute:function(){var resizableOption=znetdk.getTextFromAttr(this.element,'data-zdk-cols-resize');if(resizableOption!==!1){this.options.resizableColumns=resizableOption==='true'?!0:!1;this.element.removeAttr('data-zdk-cols-resize')}},_setMultipleSelectionFromAttribute:function(){var selectionModeOption=znetdk.getTextFromAttr(this.element,'data-zdk-multiselect');if(selectionModeOption!==!1){this.options.selectionMode=selectionModeOption==='true'?'multiple':'single';this.element.removeAttr('data-zdk-multiselect')}},_setResetSortLabelFromAttribute:function(){var buttonLabel=znetdk.getTextFromAttr(this.element,'data-zdk-resetsortlabel');if(buttonLabel!==!1){this.options.resetSortLabel=buttonLabel;this.element.removeAttr('data-zdk-resetsortlabel')}},_getNumberOfPaginatorRowsFromLocalStorage:function(){var storageKeyPrefix='zdkdatatable_rows_',storageKey=storageKeyPrefix+this.element.attr('id');if(storageKey===storageKeyPrefix){return!1}
try{var storedValue=znetdk.getLocalSettings(storageKey);if(storedValue){this.options.paginator.rows=Number(storedValue);return!0}else{return!1}}catch(e){console.log('zdkdatatable: no local storage available to retrieve the paginator rows number!');return!1}},_getRowIndex:function(row){var index=row.index();var first=this.options.lazy?0:this._getFirst();return this.options.paginator?first+index:index},_addSelection:function(rowIndex){var first=this.options.lazy?this._getFirst():0;if(!this._isSelected(first+rowIndex)){this.selection.push(first+rowIndex)}},_removeSelection:function(rowIndex){var first=this.options.lazy?this._getFirst():0;this.selection=$.grep(this.selection,function(value){return value!==first+rowIndex})},getSelection:function(){var first=this.options.lazy?this._getFirst():0;var selections=[];if(this.selection===undefined){return[]}
for(var i=0;i<this.selection.length;i++){selections.push(this.data[this.selection[i]-first])}
return selections},getRowData:function(row){var rowIndex=this._getRowIndex(row);return typeof this.data[rowIndex]==='undefined'?null:this.data[rowIndex]},selectRowByValue:function(columnField,value){var columnIndex=null,selectedRow=null;for(var j=0;j<this.options.columns.length;j++){var columnOptions=this.options.columns[j];if(columnOptions.field===columnField){columnIndex=j+1;break}}
if(columnIndex===null){console.log("zdkdatatable.selectRowByValue(): column '"+columnField+"' not found!");return}
this.element.find('tr > td:nth-child('+columnIndex+')').each(function(){var currentValue=$(this).text();if(currentValue===value){selectedRow=$(this).parent();return!1}});if(selectedRow!==null&&selectedRow.length===1){this.selectRow(selectedRow)}},selectRowById:function(id,silent){var idName=this.options.keepSelectionOnId!==null?this.options.keepSelectionOnId:'id',currentIndex=null;for(var j=0;j<this.data.length;j++){if(this.data[j][idName]===id){currentIndex=j+1;break}}
if(currentIndex!==null){var matchingRow=this.element.find('tr:nth-child('+currentIndex+')');this.selectRow(matchingRow,silent)}},empty:function(){this.data=[];this._setTotalInCaption(0);this.filterCriteria=null;if(this.paginator!==undefined){this.setPaginator('page',0);this.setPaginator('totalRecords',0);this.paginator.puipaginator('refresh')}
this._renderData()},_renderData:function(){this._super();this._addColumnTooltips();this._addIconLinks();this._makeColumnsResizable()},_addColumnTooltips:function(){if(this.data){var tooltipColumns=[];for(var j=0;j<this.options.columns.length;j++){var columnOptions=this.options.columns[j];if(columnOptions.tooltip===!0){tooltipColumns.push(j+1)}}
for(var i=0;i<tooltipColumns.length;i++){var columnPosition=tooltipColumns[i];this.tbody.find('td:nth-child('+columnPosition+')').each(function(){$(this).attr('title',$(this).text())})}}},_addIconLinks:function(){var $this=this;if(this.data){var iconColumns=[];for(var j=0;j<this.options.columns.length;j++){var columnOptions=this.options.columns[j];if(columnOptions.icon!==undefined){iconColumns.push({position:j+1,iconClass:columnOptions.icon,fieldValueTriggered:columnOptions.fieldValueTriggered})}}
for(var i=0;i<iconColumns.length;i++){var columnPosition=iconColumns[i].position;this.tbody.find('td:nth-child('+columnPosition+')').each(function(){var iconPrefix=iconColumns[i].iconClass.substring(0,3),cellValue=$(this).text(),doesCellValueExist=cellValue.length,iconClassWithValue=doesCellValueExist&&iconPrefix==='ui-'?' ui-icon-with-value':'',iconClasses=(iconPrefix==='fa-'?'fa ':'ui-icon ')+iconColumns[i].iconClass,icon=$('<span class="'+iconClasses+iconClassWithValue+'"></span>');if(doesCellValueExist){$(this).empty();$(this).append('<span class="'+iconPrefix+'cell-value">'+cellValue+'</span>')}
$(this).prepend(icon);if(iconColumns[i].fieldValueTriggered!==undefined){$this._handleClickOnIconLinkEvents(icon,iconColumns[i].fieldValueTriggered)}})}}},_handleClickOnIconLinkEvents:function(icon,fieldValueTriggered){var rowPosition=this._getRowIndex(icon.closest('tr')),fieldValue=this._getCellValue(fieldValueTriggered,rowPosition),$this=this;icon.click(function(event){$this._trigger('iconclick',event,fieldValue)})},_getCellValue:function(fieldName,rowPosition){var cellValue=null;if(rowPosition<this.data.length&&rowPosition>=0&&this.data[rowPosition][fieldName]!==undefined){return this.data[rowPosition][fieldName]}
return cellValue},_makeColumnsResizable:function(){if(!this.options.resizableColumns){return!1}
this._setColumnWidthsFromLocalStorage();var $this=this,thHeight=this.thead.find('th:first').height();this.thead.find('th').resizable({handles:"e",minHeight:thHeight,maxHeight:thHeight,minWidth:10,resize:function(event,ui){$(event.target).width(ui.size.width);$this._storeLocallyNewColumnWidth(ui.element.index(),ui.size.width)}})},_storeLocallyNewColumnWidth:function(headingCellIndex,columnWidth){var columnName=this.options.columns[headingCellIndex].field,storageKeyPrefix='zdkdatatable_'+this.element.attr('id')+'_column_width_',storageKey=storageKeyPrefix+columnName;znetdk.storeLocalSettings(storageKey,columnWidth)},_setColumnWidthsFromLocalStorage:function(){var storageKeyPrefix='zdkdatatable_'+this.element.attr('id')+'_column_width_';for(var j=0;j<this.options.columns.length;j++){var columnOptions=this.options.columns[j],columnWidth=znetdk.getLocalSettings(storageKeyPrefix+columnOptions.field);if(columnWidth!==!1){this.thead.find('th.'+columnOptions.headerClass).width(columnWidth)}}},_setTotalInCaption:function(total){if(this.options.totalInCaption){var captionElement=this.element.children('.pui-datatable-caption').first();if(captionElement.length){captionElement.text(total+' '+this.originalCaption)}else{this.originalCaption=this.options.caption;this.options.caption=total+' '+this.originalCaption}}},_getResetSortButton:function(){if(this.options.resetSortLabel===null){return!1}
var existingButtonElement=this.element.find('.zdk-datatable-resetsortbutton');if(existingButtonElement.length===1){return existingButtonElement}
this.element.children('.pui-datatable-caption').after('<button class="zdk-datatable-resetsortbutton" type="button">'+this.options.resetSortLabel+'</button>');var newButtonElement=this.element.find('.zdk-datatable-resetsortbutton');newButtonElement.puibutton({icon:'fa-sort-alpha-asc'});this._handleResetSortButtonClick(newButtonElement);return newButtonElement},_showHideResetSortButton:function(isVisible){var buttonElement=this._getResetSortButton();if(buttonElement===!1){return!1}
if(isVisible===!1){buttonElement.hide()}else{buttonElement.show()}},_handleResetSortButtonClick:function(buttonElement){var $this=this;buttonElement.on('click.zdkdatatable',function(event){event.preventDefault();var currentSortedColumn=$this.thead.children('th.pui-sortable-column.ui-state-active');currentSortedColumn.data('order',0).removeClass('ui-state-active').children('span.pui-sortable-column-icon').removeClass('ui-icon-triangle-1-n ui-icon-triangle-1-s');$this.options.sortField=null;$this.options.sortOrder=null;$this.refresh();$this._showHideResetSortButton(!1)})},_addHeaderAndBodyClasses:function(){for(var j=0;j<this.options.columns.length;j++){this.options.columns[j].headerClass='zdk-col-'+this.options.columns[j].field;this.options.columns[j].bodyClass='zdk-col-'+this.options.columns[j].field}},_allowHtmlForColumns:function(){for(var j=0;j<this.options.columns.length;j++){if(this.options.columns[j].hasOwnProperty('isHtml')&&this.options.columns[j].isHtml===!0){const field=this.options.columns[j].field;this.options.columns[j].content=contentInHtml;function contentInHtml(rowData){return rowData[field]}}}}})});$(function(){$.widget("primeui.puidialog",$.primeui.puidialog,{options:{autoHeight:!1},_create:function(){this._setAutoHeightFromAttribute();this._super();this._setTitleBarIconFromAttribute();this._setSize();if(this.options.appendTo===null){this.element.appendTo('body')}},getTitle:function(){return this.element.find('div.pui-dialog-titlebar > span.pui-dialog-title').text()},setTitle:function(title){this.element.find('span.pui-dialog-title').text(title)},_setSize:function(){this.element.css('width',this.options.width);if(this.options.autoHeight){this._setAutoHeight()}else{this.element.css('height','auto');this.content.height(this.options.height)}
if(this.options.appendTo&&!this.options.autoHeight){this.content.css('max-height',this.options.appendTo.height()-50)}},_setAutoHeight:function(){var windowHeight=$(window).height(),dialogPosition=this.element[0].getBoundingClientRect(),dialogHeight=windowHeight-dialogPosition.top-5;this.element.height(dialogHeight);this._setContentAutoHeight()},_setContentAutoHeight:function(){var dialogOuterHeight=this.element.outerHeight(!0),titleBarOuterHeight=this.titlebar.outerHeight(!0),contentOuterHeight=this.content.outerHeight(!0),contentHeight=this.content.height();this.content.height(dialogOuterHeight-titleBarOuterHeight-contentOuterHeight+contentHeight)},_initPosition:function(){this.element.css({left:0,top:0});if(/(center|left|top|right|bottom)/.test(this.options.location)){this.options.location=this.options.location.replace(',',' ');this.element.position({my:'center',at:this.options.location,collision:'fit',of:window,using:function(pos){var l=pos.left<0?0:pos.left,t=pos.top<0?0:pos.top;$(this).css({left:l,top:t})}})}else{var coords=this.options.location.split(','),x=$.trim(coords[0]),y=$.trim(coords[1]);this.element.offset({left:x,top:y});if(this.options.autoHeight){this.element.css('top',0)}}
this.positionInitialized=!0},show:function(){var sizeToOriginal=!1;if(this.element.is(':visible')){sizeToOriginal=!0}
this._super();if(sizeToOriginal){this._setSize()}else if(this.options.autoHeight){this._setAutoHeight()}},_bindEvents:function(){this._super();var $this=this;this.element.click(function(e){if(typeof e.originalEvent!=='undefined'&&$(e.originalEvent.target).is("div")&&($(e.originalEvent.target).hasClass('ui-widget-header')||$(e.originalEvent.target).hasClass('ui-widget-content'))){$this.moveToTop()}});this.closeIcon.off('click.puidialog');this.closeIcon.on('click.puidialog',function(e){if($this._trigger('close')){$this.hide()}
e.preventDefault()});if(this.options.closeOnEscape){$(document).off('keydown.dialog_'+this.element.attr('id'));$(document).on('keydown.dialog_'+this.element.attr('id'),function(e){var keyCode=$.ui.keyCode,active=parseInt($this.element.css('z-index'),10)===PUI.zindex;if(e.which===keyCode.ESCAPE&&$this.element.is(':visible')&&active){if($this._trigger('close')){$this.hide()}}})}
if(this.options.autoHeight){$(window).on('resize',function(event){if(event.target===window){$this._setAutoHeight()}})}},_setupResizable:function(){if(this.options.appendTo){this.element.resizable({maxWidth:this.options.appendTo.width(),maxHeight:this.options.appendTo.height()})}
this._super();this.element.css('position','');this.element.css('position','abosolute')},_setupDraggable:function(){this._super();this.element.css('position','');this.element.css('position','abosolute')},moveToTop:function(){if(this.element.is(':visible')){var active=parseInt(this.element.css('z-index'),10)===PUI.zindex;if(!active){this._moveToTop();this._trigger('movedtotop',null)}}},_setOption:function(key,value){this._super(key,value);if(key==='location'){this._initPosition()}else if(key==='width'){this.element.css('width',value);this.content.css('width','auto')}else if(key==='height'){this.element.css('height','auto');this.content.css('height',value)}},isHidden:function(){return this.element.attr('aria-hidden')==="true"},_applyFocus:function(){var autofocusElement=this.element.find(':input:visible:enabled.zdk-autofocus,input:radio:visible:enabled:checked.zdk-autofocus,'+'select:visible:enabled.zdk-autofocus,button:visible:enabled.zdk-autofocus,'+'textarea:visible:enabled.zdk-autofocus').first();if(autofocusElement.length===0){autofocusElement=this.element.find(':not(:submit):not(:button):not(:radio):input:visible:enabled,'+'input:radio:visible:enabled:checked,select:visible:enabled,'+'textarea:visible:enabled').first()}
if(autofocusElement.length===1){if(autofocusElement.is('input')){autofocusElement.select()}
autofocusElement.focus()}},_postHide:function(){if(this.options.modal){this._disableModality(!0)}
this._super()},_disableModality:function(noSilent){if(noSilent&&this.modality!==null){this._super()}},_setAutoHeightFromAttribute:function(){var responsiveAttrib=znetdk.getTextFromAttr(this.element,'data-zdk-autoheight');if(responsiveAttrib!==!1&&responsiveAttrib==='true'){this.options.autoHeight=!0;if(this.options.width==='100%'){this.options.location='0,0'}}},_setTitleBarIconFromAttribute:function(){var titleBarIcon=this.element.data('icon');if(typeof titleBarIcon==="undefined"){return!1}
this.element.find('span.pui-dialog-title').before('<i class="fa '+titleBarIcon+' fa-lg"/>');return!0}})});$(function(){$.widget("znetdk.zdkdropdown",$.primeui.puidropdown,{options:{controller:null,action:null,noSelectionOption:null,defaultSelectedValue:null,loadOnCreate:'yes'},_create:function(){this._setOptionsFromAttribute();var userStyle=this.element.attr('style');if(!userStyle||userStyle.indexOf('width')===-1){this.element.attr('style','width:184px;')}
if(this.options.noSelectionOption&&this.options.controller===null){this.element.prepend('<option value="_">'+this.options.noSelectionOption+'</option>');var defaultSel=this.element.find('[selected]');if(defaultSel.length===0){this.element.val('_')}}
if(this.options.loadOnCreate==='yes'){this._loadData(this.options.defaultSelectedValue,this._super)}else{this._super()}},_loadData:function(selectedItemValue,callbackMethod){selectedItemValue=selectedItemValue===undefined?null:selectedItemValue;if(this.options.controller&&this.options.action){var $this=this;znetdk.request({control:this.options.controller,action:this.options.action,callback:function(response){if(response.success===!0){if($this.options.noSelectionOption){response.rows.splice(0,0,{label:$this.options.noSelectionOption,value:'_'})}
if(callbackMethod){$this.options.data=response.rows;callbackMethod.call($this)}else{$this._setOption('data',response.rows)}
$this._changeNoSelectionValue();if(selectedItemValue!==null){$this.selectValue(selectedItemValue)}
$this._trigger('dataloaded')}else{znetdk.message('error',response.summary,response.msg);if(callbackMethod){callbackMethod.call($this)}}}})}else{if(callbackMethod){callbackMethod.call(this)}
this._changeNoSelectionValue()}},_triggerChange:function(edited){this._super(edited);if(this.options.change===undefined){this._trigger('change')}},refresh:function(keepSelection){if(keepSelection){var selectedItem=this.getSelectedValue();this._loadData(selectedItem)}else{this._loadData()}},selectFirst:function(){if(this.items!==undefined){this._selectItem(this.items.eq(0),!0)}},resetSelection:function(){if(this.options.defaultSelectedValue){var selectedOption=this.getSelectedValue();if(selectedOption!==this.options.defaultSelectedValue){this.selectValue(this.options.defaultSelectedValue)}}else{var defaultSel=this.element.find('[selected]');if(defaultSel.length===0){this.selectFirst()}else{this.selectValue(defaultSel.first().val())}}},setFocus:function(){this.focusElement.trigger('focus.puidropdown')},isValueSelected:function(){var selectedValue=this.getSelectedValue();if(selectedValue==='_'){return!1}
return!0},_setOptionsFromAttribute:function(){var actionAttrib=znetdk.getActionFromAttr(this.element),noSelAttrib=znetdk.getTextFromAttr(this.element,'data-zdk-noselection'),defValue=znetdk.getTextFromAttr(this.element,'data-zdk-value'),loadOnCreate=znetdk.getTextFromAttr(this.element,'data-zdk-loadoncreate');if(actionAttrib!==!1){this.options.controller=actionAttrib.controller;this.options.action=actionAttrib.action}
if(noSelAttrib!==!1){this.options.noSelectionOption=noSelAttrib}
if(defValue!==!1){this.options.defaultSelectedValue=defValue}
if(loadOnCreate!==!1){this.options.loadOnCreate=loadOnCreate}},_changeNoSelectionValue:function(){var optionForNoSelection=this.choices.filter("[value='']");if(optionForNoSelection.length){optionForNoSelection.attr('value','_')}},_initDimensions:function(){this._super();var labelWidth=this.label.width()-(this.menuIcon.outerWidth(!0)-this.menuIcon.width())-(this.label.outerWidth(!0)-this.label.width());this.label.width(labelWidth);this.panel.width(this.container.innerWidth())},enable:function(){if(this.label.hasClass('ui-state-disabled')){this._super();this.element.prop('disabled',!1);this.container.find('input').prop('disabled',!1)}},disable:function(){this._super();this.element.prop('disabled',!0);this.container.find('input').prop('disabled',!0)},_unbindEvents:function(){this._super();this.focusElement.off()},getDataOfSelectedValue:function(){var value=this.getSelectedValue(),option=this.choices.filter('[value="'+value+'"]'),index=option.index();if(this.options.data&&index>=0&&index<this.options.data.length){var data=this.options.data[index];return data}else{return!1}},selectValue:function(value){var selectElName=typeof this.element==='undefined'?'????':this.element.attr('name');if(this.options.loadOnCreate!=='yes'&&(typeof this.choices==='undefined'||this.choices.length===0)){this._loadData(value)}else if(typeof this.choices!=='undefined'&&this.choices.length>0){var option=this.choices.filter('[value="'+value+'"]');if(option.length===1){this._super(value)}else{console.error("zdkdropdown.selectValue(): value '"+value+"' does not exist in dropdown list named "+"'"+selectElName+"'.")}}else{console.error('zdkdropdown.selectValue(): no option is defined for the dropdown list named '+"'"+selectElName+"'.")}}})});$.widget("znetdk.zdkform",{options:{controller:null,action:null,complete:null,failed:null,initdone:null,ready:null,msgsuccess:!0},_create:function(){var actionAttrib=this.element.attr('data-zdk-action');if(actionAttrib!==undefined){var actionArray=actionAttrib.split(":");this.options.controller=actionArray[0];this.options.action=actionArray[1]}
this.formErrorMsgArea=$('<p class="zdk-form-error-msg ui-helper-hidden ui-state-error ui-corner-all"/>').prependTo(this.element);this.formErrorMsgArea.append('<span class="fa fa-warning fa-lg"></span>');this.formErrorMsgArea.append('<span class="error_message"/>');this.isErrorMsgDisplayed=!1;this.firstElementNameInError="";this._bindEvents();this.element.find('input:not(:radio),textarea,.zdk-radiobuttongroup,.zdk-listbox,.zdk-dropdown,.zdk-textvalue,.zdk-inputhtml,.zdk-multiupload').each(function(){var labelElement=$(this).prev();if(labelElement.is('label')){var extraElement=null;if($(this).prop('required')===!0||$(this).attr('data-required')==='true'){labelElement.addClass('zdk-required')}
if($(this).is("textarea,:checkbox,.zdk-radiobuttongroup,.zdk-listbox, .zdk-dropdown, :file, .zdk-inputhtml, .zdk-multiupload")&&!$(this).parent().hasClass('zdk-inputrows')){labelElement.addClass('zdk-align-top')}
if($(this).is(":checkbox")){var spanElement=$(this).next();if(spanElement.is('span')){extraElement=spanElement}}
if(!$(this).parent().hasClass('zdk-form-entry')&&!$(this).parent().hasClass('zdk-inputrows')){var contentToWrap=extraElement===null?$(this).add(labelElement):$(this).add(labelElement).add(extraElement);contentToWrap.wrapAll('<div class="zdk-form-entry"/>')}}});this.element.children('button').wrapAll('<div class="zdk-form-buttonpane ui-widget-content ui-helper-clearfix"/>');var buttonPane=this.element.children('.zdk-form-buttonpane'),buttonPanePrevElem=buttonPane.prev();if(buttonPanePrevElem.length&&buttonPanePrevElem.is('fieldset')){buttonPane.css({'border-width':'0','margin':0})}
znetdk.initCommonWidgets(this.element);this.formDataModified=!1;this._trigger("ready")},_bindEvents:function(){var $this=this;this.element.on('submit.zdkform',this,this._submit);this.element.on('reset.zdkform',this,this._reset);if(this._html5validation()){this.element.find('input:not(:radio),.zdk-listbox,textarea').each(function(){$(this).uniqueId().on('invalid.zdkform_'+$(this).attr('id'),$this,$this._setControlInvalid).on('change.zdkform_'+$(this).attr('id'),$this,$this._setControlValid)});this.element.find('input:radio').each(function(){$(this).uniqueId().on('invalid.zdkform_'+$(this).attr('id'),$this,$this._setControlInvalid).on('puiradiobuttonselectionchange.zdkform_'+$(this).attr('id'),$this,$this._setControlValid)})}
this.element.find('.zdk-dropdown').each(function(){$(this).uniqueId().bind('zdkdropdownchange.zdkform_'+$(this).attr('id'),$this,$this._setControlValid)});this.element.find('.zdk-inputhtml').each(function(){$(this).uniqueId().bind('zdkinputhtmlchange.zdkform_'+$(this).attr('id'),$this,$this._setControlValid)});this.element.find('.zdk-multiupload').each(function(){$(this).uniqueId().bind('zdkmultiuploadselect.zdkform_'+$(this).attr('id'),$this,$this._setControlValid)});this.element.find('.zdk-autocomplete').each(function(){$(this).uniqueId().bind('zdkautocompleteselect.zdkform_'+$(this).attr('id'),$this,$this._setControlValid)});this.element.find('.zdk-inputrows').bind('zdkinputrowsinitialized',function(){$(this).find('tr:gt(0) input').each(function(){$(this).uniqueId().on('invalid.zdkform_'+$(this).attr('id'),$this,$this._setControlInvalid).on('change.zdkform_'+$(this).attr('id'),$this,$this._setControlValid)})});this.element.find('.zdk-inputrows').bind('zdkinputrowsnewrow',function(event,row){$(row).find('input').each(function(){$(this).uniqueId().on('invalid.zdkform_'+$(this).attr('id'),$this,$this._setControlInvalid).on('change.zdkform_'+$(this).attr('id'),$this,$this._setControlValid)})}).bind('zdkinputrowsremoved',function(){$this.formDataModified=!0}).bind('zdkinputrowserased',function(){$this.formDataModified=!0})},reset:function(){this.element[0].reset();this.formDataModified=!1},init:function(values){this.reset();if(values!==undefined){this.setValues(values);this._trigger("initdone")}},setValues:function(values){if(values!==undefined){var property,inputElement;for(property in values){inputElement=this.element.find(":input,.zdk-listbox,.zdk-tree,.zdk-dropdown,.zdk-textvalue,.zdk-inputhtml,.zdk-multiupload").filter("[name='"+property+"'],[data-name='"+property+"']");if(inputElement.length){if(inputElement.attr("type")==="checkbox"){if(inputElement.val()===values[property]){inputElement.puicheckbox('check',!1,!0)}else{inputElement.puicheckbox('uncheck',!0)}}else if(inputElement.attr("type")==="radio"){inputElement.puiradiobutton('select',values[property])}else if(inputElement.hasClass("zdk-listbox")){var selectedOptions=values[property];if($.type(selectedOptions)==='array'){inputElement.zdklistbox('selectItemsByValues',selectedOptions)}else if($.type(selectedOptions)==='string'){inputElement.zdklistbox('selectItemByValue',selectedOptions)}}else if(inputElement.hasClass("zdk-dropdown")){var selectedOption=values[property];inputElement.zdkdropdown('selectValue',selectedOption)}else if(inputElement.hasClass('zdk-tree')){inputElement.zdktree('selectNodes',values[property])}else if(inputElement.hasClass('zdk-date')){inputElement.zdkinputdate('setW3CDate',values[property])}else if(inputElement.hasClass('zdk-inputhtml')){inputElement.zdkinputhtml('setValue',values[property])}else if(inputElement.hasClass('zdk-multiupload')){inputElement.zdkmultiupload('setUploadedFiles',values[property])}else if(inputElement.hasClass('zdk-textvalue')){inputElement.text(values[property])}else{inputElement.val(values[property])}}}}},setReadOnly:function(readOnly){var widgetState=readOnly===!0?'disable':'enable';this.element.find("input[type!='hidden'],textarea,select,.zdk-tree,."+"zdk-inputhtml,.zdk-multiupload,.zdk-inputhtml,.zdk-inputrows").each(function(){if($(this).attr("type")==="checkbox"){$(this).puicheckbox(widgetState)}else if($(this).attr("type")==="radio"){$(this).puiradiobutton(widgetState)}else if($(this).attr("type")==="file"){}else if($(this).hasClass('zdk-date')){$(this).zdkinputdate(widgetState)}else if($(this).hasClass('zdk-autocomplete')){$(this).zdkautocomplete(widgetState)}else if($(this).hasClass('zdk-dropdown')){$(this).zdkdropdown(widgetState)}else if($(this).hasClass('zdk-listbox')){$(this).zdklistbox(widgetState)}else if($(this).hasClass('zdk-tree')){}else if($(this).hasClass('zdk-multiupload')){$(this).zdkmultiupload(widgetState)}else if($(this).hasClass('zdk-inputhtml')){$(this).zdkinputhtml(widgetState)}else if($(this).hasClass('zdk-inputrows')){$(this).zdkinputrows(widgetState)}else if($(this).is('textarea')&&$(this).hasClass('pui-inputtext')){$(this).prop('readonly',readOnly===!0)}else if($(this).is('input')&&$(this).hasClass('pui-inputtext')){$(this).prop('readonly',readOnly===!0)}})},_html5validation:function(){return'noValidate' in document.createElement('form')},_setControlInvalid:function(event){var message='';if(this.validity.valueMissing&&$(this).attr("data-zdkerrmsg-required")!==undefined){message=$(this).attr("data-zdkerrmsg-required")}else if(this.validity.valueMissing&&event.data._getRequiredMsgFromAttr()){message=event.data._getRequiredMsgFromAttr()}else if(this.validity.typeMismatch&&$(this).attr("data-zdkerrmsg-type")!==undefined){message=$(this).attr("data-zdkerrmsg-type")}else if(this.validity.rangeUnderflow&&$(this).attr("data-zdkerrmsg-min")!==undefined){message=$(this).attr("data-zdkerrmsg-min")}else if(this.validity.rangeOverflow&&$(this).attr("data-zdkerrmsg-max")!==undefined){message=$(this).attr("data-zdkerrmsg-max")}else if(this.validity.patternMismatch&&$(this).attr("data-zdkerrmsg-pattern")!==undefined){message=$(this).attr("data-zdkerrmsg-pattern")}else if(this.validity.stepMismatch&&$(this).attr("data-zdkerrmsg-step")!==undefined){message=$(this).attr("data-zdkerrmsg-step")}else{message=this.validationMessage}
event.preventDefault();event.data._showErrorMessage(message,event.data._getElementNameInError($(this)))},_getElementNameInError:function(elementInError){var elementName=elementInError.attr("name"),elementsWithSameName=this.element.find("[name='"+elementName+"']"),elementPosition=0;if(elementsWithSameName.length>1){elementsWithSameName.each(function(index){if($(this).is(elementInError)){elementPosition=index;return!1}});elementName=elementName+':'+elementPosition}
return elementName},_setControlValid:function(event){if(event.type==='zdkdropdownchange'){$(this).parents('.pui-dropdown').removeClass('znetdk_error')}else if($(this).is(':file')){$(this).next('.pui-button').removeClass('znetdk_error')}else if(event.type==='zdkmultiuploadselect'){$(this).children('.pui-button').removeClass('znetdk_error')}else{$(this).removeClass('znetdk_error')}
event.data.isErrorMsgDisplayed=!1;event.data.firstElementNameInError="";event.data.formDataModified=!0;event.data._hideErrorMessage(!1,function(){})},_getElementInError:function(elementName){if(elementName===undefined){return undefined}
var namePieces=elementName.split(':',2);if(namePieces.length===2&&$.isNumeric(namePieces[1])&&Math.floor(namePieces[1])==namePieces[1]&&this.element.find("[name='"+namePieces[0]+"']").eq(namePieces[1]).length===1){return this.element.find("[name='"+namePieces[0]+"']").eq(namePieces[1])}else{return this.element.find("[name='"+elementName+"'],[data-name='"+elementName+"']").first()}},_showErrorMessage:function(message,elementName){if(elementName===undefined&&message===undefined){return}
if(this.firstElementNameInError===""){this.firstElementNameInError=elementName}
if(this.firstElementNameInError===elementName){this.formErrorMsgArea.children('span.error_message').html(message);var element=this._getElementInError(elementName),$this=this;this.formErrorMsgArea.slideDown(400,function(){$this._setFocusOnFieldInError(element)});if(!this.isErrorMsgDisplayed){this.isErrorMsgDisplayed=!0}}},_setFocusOnFieldInError:function(element){if(element===undefined){return}
var elementForFocus;if(element.hasClass('zdk-dropdown')){elementForFocus=element.parents('.pui-dropdown');element.zdkdropdown('setFocus')}else if(element.is(':file')){elementForFocus=element.next('.pui-button');element.zdkinputfile('setFocus')}else if(element.hasClass('zdk-multiupload')){elementForFocus=element.children('.pui-button').first();element.zdkmultiupload('setFocus')}else{elementForFocus=element;elementForFocus.focus();if(element.is('input:not(:radio):not(:checkbox)')){elementForFocus.select()}}
elementForFocus.addClass('znetdk_error')},_hideErrorMessage:function(immediate,callback){this.isErrorMsgDisplayed=!1;if(immediate){this.formErrorMsgArea.hide()}else{this.formErrorMsgArea.slideUp(200,callback)}},_getRequiredMsgFromAttr:function(){return znetdk.getTextFromAttr(this.element,'data-zdkerrmsg-required')},_isFormValidationRequired:function(){var novalidatePropVal=this.element.attr('novalidate');return novalidatePropVal===undefined?!0:!1},_validateDate:function(){if(!this._isFormValidationRequired()){return!0}
var $this=this,result=!0;this.element.find('input.zdk-date').each(function(){if(!$(this).zdkinputdate('checkDate')){var errorMessage=$(this).attr("data-zdkerrmsg-date");if(errorMessage===undefined){errorMessage='Date format is invalid!'}
$this.isErrorMsgDisplayed=!1;$this._showErrorMessage(errorMessage,$(this).attr("name"));result=!1;return!1}});return result},_validateDropdown:function(){if(!this._isFormValidationRequired()){return!0}
var $this=this,result=!0;this.element.find('select.zdk-dropdown[required]').each(function(){if(!$(this).zdkdropdown('isValueSelected')){var errorMessage=$(this).attr("data-zdkerrmsg-required");if(errorMessage===undefined){errorMessage=$this._getRequiredMsgFromAttr();if(errorMessage===!1){errorMessage='A value must be selected!'}}
$this.isErrorMsgDisplayed=!1;$this._showErrorMessage(errorMessage,$(this).attr("name"));result=!1;return!1}});return result},_validateInputHtml:function(){if(!this._isFormValidationRequired()){return!0}
var $this=this,result=!0;this.element.find('div.zdk-inputhtml[data-required=true]').each(function(){if($(this).zdkinputhtml('isEmpty')){var errorMessage=$(this).attr("data-zdkerrmsg-required");if(errorMessage===undefined){errorMessage=$this._getRequiredMsgFromAttr();if(errorMessage===!1){errorMessage='A value must be entered!'}}
$this.isErrorMsgDisplayed=!1;$this._showErrorMessage(errorMessage,$(this).attr("data-name"));result=!1;return!1}});return result},_validateMultiUpload:function(){if(!this._isFormValidationRequired()){return!0}
var $this=this,result=!0;this.element.find('div.zdk-multiupload[data-required=true]').each(function(){if($(this).zdkmultiupload('isEmpty')){var errorMessage=$(this).attr("data-zdkerrmsg-required");if(errorMessage===undefined){errorMessage=$this._getRequiredMsgFromAttr();if(errorMessage===!1){errorMessage='At least one file must be selected!'}}
$this.isErrorMsgDisplayed=!1;$this._showErrorMessage(errorMessage,$(this).attr("data-name"));result=!1;return!1}});return result},_validate:function(){if(!this._validateDate()||!this._validateDropdown()||!this._validateInputHtml()||!this._validateMultiUpload()){return!1}
if(this._html5validation()){return!0}else{if(!this._isFormValidationRequired()){return!0}
var $this=this,result=!0;this.element.find('input[required]').each(function(){if($(this).val()===''){var errorMessage=$(this).attr("data-zdkerrmsg-required");if(errorMessage===undefined){errorMessage=$this._getRequiredMsgFromAttr();if(errorMessage===!1){errorMessage='This is a required field!'}}
$this.isErrorMsgDisplayed=!1;$this._showErrorMessage(errorMessage,$(this).attr("name"));result=!1;return!1}});return result}},getFormData:function(getEmptyInputs){var formData=new Array(),getAll=getEmptyInputs===undefined?!1:Boolean(getEmptyInputs);this.element.find("input[type!='radio'],textarea,select,.zdk-tree,.zdk-picklist,.zdk-radiobuttongroup,.zdk-inputhtml,button:submit:focus").filter("[name],[data-name]").each(function(){var noValue="";var elementName=$(this).attr('name')===undefined?$(this).attr('data-name'):$(this).attr('name');if(elementName!==""&&elementName!==undefined){if($(this).hasClass('zdk-date')){if($(this).val().trim()!==""||getAll){formData.push({name:elementName,value:$(this).zdkinputdate('getW3CDate')})}}else if($(this).hasClass('zdk-listbox')){var selectedOptions=$(this).val();if(selectedOptions===null&&getAll){formData.push({name:elementName,value:noValue})}else if(selectedOptions!==null&&$.type(selectedOptions)==='array'){for(i=0;i<selectedOptions.length;++i){formData.push({name:elementName,value:selectedOptions[i]})}}else if(selectedOptions!==null&&$.type(selectedOptions)==='string'){formData.push({name:elementName,value:selectedOptions})}}else if($(this).hasClass('zdk-dropdown')){if($(this).val()!=="_"||getAll){formData.push({name:elementName,value:($(this).val()==="_"?noValue:$(this).val())})}}else if($(this).is(':checkbox')){if($(this).is(':checked')||getAll){var checkedValue=$(this).is(':checked')?$(this).val():noValue;formData.push({name:elementName,value:checkedValue})}}else if($(this).hasClass('zdk-radiobuttongroup')){var checkedValue=$(this).find(':checked').val();if(checkedValue!==undefined||getAll){formData.push({name:elementName,value:(checkedValue===undefined?noValue:checkedValue)})}}else if($(this).hasClass('zdk-tree')){var selectedNodes=$(this).zdktree('getSelection');if(selectedNodes.length||getAll){formData=formData.concat(selectedNodes)}}else if($(this).hasClass('zdk-inputhtml')){if(!$(this).zdkinputhtml('isEmpty')||getAll){formData.push({name:elementName,value:$(this).zdkinputhtml('getValue')})}}else if($(this).hasClass('zdk-picklist')){var selectedItems=$(this).zdkpicklist('getSelection');if(selectedItems.length||getAll){formData=formData.concat(selectedItems)}}else if($(this).is(':file')){if($(this).val()!==""||getAll){formData.push({name:elementName,value:$(this).val()})}}else if($(this).is(':button')){if($(this).val()!==""||getAll){formData.push({name:elementName,value:$(this).val()})}}else if(getAll||!$(this).is(':disabled')||($(this).is(':disabled')&&$(this).val().trim()!=="")){if($(this).val().trim()!==""||getAll){formData.push({name:elementName,value:$(this).hasClass('zdk-form-notrim')?$(this).val():$(this).val().trim()})}}}});return formData},getInputValues:function(elementName){var formData=this.getFormData(!0),values=[];for(i=0;i<formData.length;i++){if(formData[i].name===elementName){values.push(formData[i].value)}}
return values.length===0?null:values},showCustomError:function(message,fieldInError){if(message.length===0){this._hideErrorMessage(!0)}else{this._submitFailed({msg:message,ename:fieldInError})}},isFormModified:function(){return this.formDataModified},setFormModified:function(isModified){this.formDataModified=isModified?!0:!1},_reset:function(event){var $this=event.data;$this.element.find('.znetdk_error').removeClass('znetdk_error');$this.firstElementNameInError="";$this.element.find(':checkbox').each(function(){if($(this).is('[checked]')){$(this).puicheckbox('check',!1,!0)}else{$(this).puicheckbox('uncheck',!0)}});$this.element.find('.zdk-radiobuttongroup').each(function(){$(this).zdkradiobuttongroup('resetSelection')});$this.element.find('select.zdk-listbox').each(function(){$(this).zdklistbox('resetSelection')});$this.element.find('select.zdk-dropdown').each(function(){$(this).zdkdropdown('resetSelection')});$this.element.find('.zdk-tree').each(function(){$(this).zdktree('unselectAllNodes')});$this.element.find(':file').each(function(){$(this).zdkinputfile('reset')});$this.element.find('.zdk-multiupload').each(function(){$(this).zdkmultiupload('reset')});$this.element.find('.zdk-inputhtml').each(function(){$(this).zdkinputhtml('empty')});$this.element.find('.zdk-picklist').each(function(){$(this).zdkpicklist('reset')});$this.element.find('.zdk-textvalue').each(function(){$(this).text('')});$this.element.find('input[name],textarea').not(':radio').not(':checkbox').not(':file').each(function(){$(this).val(null)});$this._hideErrorMessage(!1,function(){$this.element.find('input[type!=hidden]:visible:enabled:not(:radio),input:radio:visible:enabled:checked,select:visible:enabled').first().focus()});$this._trigger("resetdone");return!1},_submitSucceeded:function(response){this.formDataModified=!1;var $this=this;this._hideErrorMessage(!1,function(){$this._trigger("complete",$this,response);var datatable=znetdk.getElementFromAttr($this.element,'data-zdk-datatable');if(datatable!==!1){datatable.zdkdatatable('option','keepSelectionOnId',$this._getRowIdParamName());datatable.zdkdatatable('refresh')}});if(response!==undefined&&response.summary&&response.msg&&this.options.msgsuccess){var levelMsg=response.warning===!0?'warn':'info';znetdk.message(levelMsg,response.summary,response.msg)}else if(response!==undefined&&response.multi_messages&&this.options.msgsuccess){znetdk.multiMessages(response.multi_messages)}},_getRowIdParamName:function(){var idName='id',inputElement=this.element.find('input.zdk-row-id');if(inputElement.length){var idNameFound=znetdk.getTextFromAttr(inputElement,'name');idName=idNameFound?idNameFound:idName}
return idName},_submitFailed:function(response){this.firstElementNameInError="";this.isErrorMsgDisplayed=!1;this._showErrorMessage(response.msg,response.ename);this.isErrorMsgDisplayed=!1;this._trigger("failed",this,response)},_submitFormData:function(){if(this.options.controller&&this.options.action){var $this=this,allFormData=this.getFormData(!0),submitElement=this.element.find(':submit');if(allFormData.length===0&&submitElement.length===0){return!1}
var fullData=this.element.find('.zdk-inputrows').length>0||this.element.attr('data-zdk-allvalues')==='true';var formData=this.getFormData(fullData);znetdk.request({control:this.options.controller,action:this.options.action,data:formData,callback:function(response){if(response.success){$this._submitSucceeded(response)}else{$this._submitFailed(response)}}});return!0}
return!1},_submitFilesToUpload:function(index,successResponse){if(index===undefined){index=0}
var inputElement=this.element.find(':file:not(.zdk-nosubmit)').slice(index,index+1);if(inputElement.length===0){if(this._submitFormData()===!1){this._submitSucceeded(successResponse)}}else if(inputElement.zdkinputfile('isFileSelected')){var $this=this;try{inputElement.zdkinputfile('upload',function(response){if(response.success){$this._submitFilesToUpload(index+1,response)}else{$this._submitFailed(response)}})}catch(error){$this._submitFailed({msg:error.message,ename:inputElement.attr('name')})}}else{this._submitFilesToUpload(index+1,successResponse)}},_submit:function(event){var $this=event.data;$this.firstElementNameInError='';if($this._validate()){$this._trigger('beforesubmit');$this._submitFilesToUpload()}
event.preventDefault()}});$.widget("znetdk.zdkfullscreen",{_create:function(){},toggleFullScreen:function(){var isInFullScreen=this._isInFullScreen();if(!isInFullScreen){this._requestFullScreen()}else{this._exitFullScreen()}
this._trigger('toggle',this,{isInFullScreen:isInFullScreen})},_isInFullScreen:function(){var fullScreenElement=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||null;return fullScreenElement!==null},_requestFullScreen:function(){if(this.element[0].requestFullscreen){this.element[0].requestFullscreen()}else if(this.element[0].mozRequestFullScreen){this.element[0].mozRequestFullScreen()}else if(this.element[0].webkitRequestFullscreen){this.element[0].webkitRequestFullscreen()}else if(this.element[0].msRequestFullscreen){this.element[0].msRequestFullscreen()}
this.element.addClass('zdk-fullscreen-on')},_exitFullScreen:function(){if(document.exitFullscreen){document.exitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}
this.element.removeClass('zdk-fullscreen-on')}});$.widget("znetdk.zdkgenericmenu",{options:{htmlTarget:null},_create:function(){this.followLink=!1;var filledContent=$("#zdk-content > .zdk-filled").eq(0);if(filledContent.length){this.followLink=znetdk.isPageToBeReloaded();var viewID=this._getViewID(filledContent.attr('id'));this._setMenuItemActive(viewID);this._setBreadCrumb(this._getMenuItemLabel(viewID))}
this._bindEvents()},_bindEvents:function(){var $this=this;this.element.find('ul > li > a').click(function(event){if(!$this.followLink&&$(this).next('ul').length===0){var menuItemId=$this._getMenuItemId($(this).parent()),menuItemLabel=$(this).text();$this.displayView(menuItemId,menuItemLabel)}
if(!$this.followLink||$(this).next('ul').length){event.preventDefault()}})},displayView:function(viewID,menuItemLabel){var $this=this,menuItemId=viewID===undefined?this._getFirstChildMenuItemId():viewID,menuItemText=menuItemLabel===undefined?this._getMenuItemLabel(menuItemId):menuItemLabel;if(this.followLink){var menuItemElement=this._getMenuItem(menuItemId);location.assign(menuItemElement.children('a').first().attr('href'));return}
var containerID=this._getViewContainerID(menuItemId),containerElement=$('#'+containerID),containerExists=(containerElement.length>0),containerIsVisible=containerExists?containerElement.is(':visible'):!1;if(containerExists&&!containerIsVisible){this._showView(menuItemId,menuItemText)}else if(!containerExists){containerElement=$('<div id="'+containerID+'" class="zdk-view"/>');znetdk.loadView({htmlTarget:containerElement,control:menuItemId,action:"show",callback:function(){containerElement.hide();$this._getViewsContainer().prepend(containerElement);var datatable=containerElement.find('.zdk-synchronize');if(datatable.length===1){datatable.one("zdkdatatabledataloaded",function(){$this._showView(menuItemId,menuItemText)})}else{$this._showView(menuItemId,menuItemText)}}})}
znetdk.addLabelToTitle(menuItemText)},_getViewsContainer:function(){return this.options.htmlTarget.length?this.options.htmlTarget:$('body')},_hideDisplayedView:function(){var displayedView=this._getViewsContainer().children(".zdk-view").filter(":visible");if(displayedView.length>=1){this.lastHiddenView=displayedView.fadeOut(200,function(){console.info("Fade out has ended")})}},_getViewContainerID:function(viewID){return'znetdk-'+viewID+'-view'},_getViewID:function(viewContainerID){var splittedText=viewContainerID.split("-");return splittedText[1]},_showView:function(viewID,menuItemLabel){var $this=this;var showObj=function(){$this._setBreadCrumb(menuItemLabel);$this._setMenuItemActive(viewID);$('#'+$this._getViewContainerID(viewID)).fadeIn(200,function(){$this._trigger('aftershow',null,viewID)})};var displayedView=this._getViewsContainer().children(".zdk-view").filter(":visible");if(displayedView.length>=1){displayedView.fadeOut(200);displayedView.promise().done(function(){showObj()})}else{showObj()}},getSelectedMenuItem:function(){var selectedMenuItem=this.element.find('ul > li.active');if(selectedMenuItem.hasClass('has-sub')){selectedMenuItem=selectedMenuItem.find('li.active').not('.has-sub')}
var response=new Object();response.id=this._getMenuItemId(selectedMenuItem);response.label=this._getMenuItemLabel(response.id);return response},_getMenuItem:function(viewID){return this.element.find('ul > li[id=znetdk-'+viewID+'-menu]')},_getRootMenuItem:function(menuElement){var $this=this,result=menuElement;menuElement.parentsUntil(this.element).filter('li').each(function(){if($(this).parentsUntil($this.element).filter('li').length===0){result=$(this);return!1}});return result},_getFirstMenuItemId:function(){var firstItem=this.element.find('ul > li').first();if(firstItem.length){return this._getMenuItemId(firstItem)}else{return!1}},_getFirstChildMenuItemId:function(parent){if(parent===undefined){parent=this.element.find('ul > li').first()}
if(parent.length){var child=parent.find('ul>li').first();if(child.length){return this._getFirstChildMenuItemId(child)}else{return this._getMenuItemId(parent)}}else{return!1}},_getMenuItemId:function(menuElement){var splittedID=(menuElement.attr('id')).split("-");return splittedID[1]},_getMenuItemLabel:function(viewID){return this._getMenuItem(viewID).children("a").text()},_setBreadCrumb:function(menuText){$("#zdk-breadcrumb-text").text(menuText)},_setMenuItemActive:function(viewID){var menuItem=this._getMenuItem(viewID);this._resetMenuItemActive();menuItem.addClass('active');this._getRootMenuItem(menuItem).addClass('active')},_resetMenuItemActive:function(){this.element.find('li.active').removeClass('active')}});$(function(){$.widget("primeui.puigrowl",$.primeui.puigrowl,{_renderMessage:function(msg){this._super(msg);this.element.children('div.pui-growl-item-container').addClass(msg.severity)}})});$.widget("znetdk.zdkhelp",{_create:function(){this.closeButtonLabel=this.element.attr('data-zdk-helpclosebutton');this.helpLabel=this.element.attr('data-zdk-helptitle');this.helpLink=this.element.children('a').first();if(this.helpLink.length)
this._bindEvents()},_bindEvents:function(){var $this=this;this.helpLink.click(function(event){event.preventDefault();var selectedMenu=znetdk.getSelectedMenu();if(selectedMenu){$this._show(selectedMenu.id,selectedMenu.label)}})},_show:function(menuItemId,menuLabel){var $this=this;var helpWindowId='zdk_help_window';if($('#'+helpWindowId).length){$('#'+helpWindowId).remove()}
var title='<span>'+this.helpLabel+'</span><span>'+menuLabel+'</span>';var helpWindow=$('<div id="'+helpWindowId+'" title="'+title+'"></div>');var winContainer=$('body');var maxHeight=($(window).height()*0.75);znetdk.loadView({htmlTarget:helpWindow,control:menuItemId,action:"help",callback:function(response){if(response.success===!1){znetdk.message('warn',title,response.msg)}else{helpWindow.puidialog({minimizable:!0,showEffect:'fade',hideEffect:'fade',height:(maxHeight>500?500:maxHeight),width:($(window).width()*0.5),appendTo:winContainer,visible:!0,buttons:[{text:$this.closeButtonLabel,icon:'ui-icon-close',click:function(){helpWindow.puidialog('hide')}}]})}}})}});$(function(){$.widget("znetdk.zdkinputdate",$.primeui.puiinputtext,{options:{regional:""},_create:function(){this.element.get(0).type='text';this.element.addClass('zdk-date');this.element.attr('autocomplete','off');if(this.options.regional==='en'){this.options.regional=""}
try{this.dateFormat=$.datepicker.regional[this.options.regional].dateFormat;this.element.datepicker($.datepicker.regional[this.options.regional])}catch(error){console.info('Regional attribute "'+this.options.regional+'" not supported by the datepicker widget.');this.dateFormat=$.datepicker.regional[""].dateFormat;this.element.datepicker($.datepicker.regional[""])}
this._super()},setW3CDate:function(W3CstringDate){try{var dateObject=$.datepicker.parseDate('yy-mm-dd',W3CstringDate);this.element.val($.datepicker.formatDate(this.dateFormat,dateObject))}catch(error){console.info('String date "'+W3CstringDate+'" is not a valid W3C date.');this.element.val(W3CstringDate)}},setCurrentDate:function(difference){if(difference===undefined){this.element.datepicker('setDate','today')}else{this.element.datepicker('setDate',difference)}},getW3CDate:function(){return this._getDate()},checkDate:function(){return this._getDate(!0)},_getDate:function(checkOnly){var inputTextDate=this.element.val(),checking=checkOnly===undefined?!1:Boolean(checkOnly);try{var dateObject=$.datepicker.parseDate(this.dateFormat,inputTextDate);return checking?!0:$.datepicker.formatDate('yy-mm-dd',dateObject)}catch(error){console.info('Input date "'+inputTextDate+'" does not match the format '+this.dateFormat+'.');return checking?!1:inputTextDate}}})});$(function(){$.widget("znetdk.zdkinputfile",{options:{controller:null,action:null,showThumbnail:!0,selectButtonLabel:'Browse...',selectButtonIcon:'ui-icon-document',noFileLabel:'&lt; No file selected! &gt;',photoReductionPercent:100,minPhotoSizeForReduction:800},_create:function(){this.uploadedFileInfos=null;this._setOptionsFromAttribute();this.options.showThumbnail=this.element.hasClass('zdk-nothumbnail')?!1:this.options.showThumbnail;var titleAttr=this.element.attr('title');this.element.wrap('<div class="zdk-inputfile"/>');this.element.prop('hidden',!0).uniqueId();this.container=this.element.parent();this.selectFileButton=$('<button type="button">'+this.options.selectButtonLabel+'</button>').appendTo(this.container);if(titleAttr){this.selectFileButton.attr('title',titleAttr)}
this.selectFileButton.puibutton({icon:this.options.selectButtonIcon});this.removeFileButton=$('<button type="button"/>').appendTo(this.container);this.removeFileButton.puibutton({icon:'ui-icon-closethick'});this.selectedFileLabel=$('<span/>').appendTo(this.container);this.thumbnail=$('<img class="ui-widget-content">').appendTo(this.container);this.elementName=this.element.attr('name');this.reset();this._bindEvents()},_bindEvents:function(){var $this=this;this.element.on('change.zdkinputfile_'+$(this).attr('id'),$this,function(){var filesCount=this.files.length;if(filesCount){var originalFile=this.files[0];$this.getReducedPhoto(originalFile,function(reducedPhoto){var selectedFile=reducedPhoto!==null?reducedPhoto:originalFile;$this.currentFile=selectedFile;$this.currentFileName=selectedFile.name;$this.selectedFileLabel.text($this.currentFileName);$this.currentFileSize=selectedFile.size;$this.currentFileType=selectedFile.type;if($this.options.showThumbnail){$this.thumbnail.onload=function(){window.URL.revokeObjectURL(this.src)};$this.thumbnail.attr('src',window.URL.createObjectURL(selectedFile));$this.thumbnail.show()}
$this.removeFileButton.show();if($this.element.hasClass('zdk-autoupload')){$this.upload()}else{$this._trigger('select',$this,$this.currentFileName)}})}else{$this.reset()}});this.selectFileButton.click(function(){$this.element.click()});this.removeFileButton.click(function(){$this.reset();$this.setFocus()})},_setOptionsFromAttribute:function(){var actionAttrib=znetdk.getActionFromAttr(this.element),noFileAttrib=znetdk.getTextFromAttr(this.element,'data-zdk-nofilelabel'),selectButtonAttrib=znetdk.getTextFromAttr(this.element,'data-zdk-selbuttonlabel'),buttonIcon=znetdk.getTextFromAttr(this.element,'data-zdk-icon'),photoReductPerc=znetdk.getTextFromAttr(this.element,'data-zdk-photoreductpercent'),minPhotoSizeForReduct=znetdk.getTextFromAttr(this.element,'data-zdk-minphotosizetoreduct');if(actionAttrib!==!1){this.options.controller=actionAttrib.controller;this.options.action=actionAttrib.action}
if(noFileAttrib!==!1){this.options.noFileLabel=noFileAttrib}
if(selectButtonAttrib!==!1){this.options.selectButtonLabel=selectButtonAttrib}
if(buttonIcon!==!1){this.options.selectButtonIcon=buttonIcon}
if(photoReductPerc!==!1){this.options.photoReductionPercent=parseInt(photoReductPerc)}
if(minPhotoSizeForReduct!==!1){this.options.minPhotoSizeForReduction=parseInt(minPhotoSizeForReduct)}},_getInputNameWithoutBrackets:function(){var pos=this.elementName.lastIndexOf('[]');if(pos===-1){return this.elementName}else{return this.elementName.substr(0,pos)}},getFileData:function(){return this.currentFile},getReducedPhoto:function(file,callback){if(!file.type.startsWith("image/")){callback(file);return}
const status=znetdk.reducePhotoSizePercent(file,this.options.photoReductionPercent,this.options.minPhotoSizeForReduction,callback);if(status===!1){console.warn('[zdkinputfile] Invalid parameters,\n\
                    photo reduction failed.')}},getFileName:function(){return this.currentFileName},getFileSize:function(){return this.currentFileSize},getFileType:function(){return this.currentFileType},isFileSelected:function(){return Boolean(this.currentFileName!==undefined&&this.currentFileName!=='')},upload:function(callback){if(this.options.controller&&this.options.action&&this.elementName&&this.isFileSelected()){var $this=this;znetdk.request({control:this.options.controller,action:this.options.action,fileToUpload:{inputName:this._getInputNameWithoutBrackets(),file:this.getFileData()},callback:function(response){if(callback===undefined){if(response.success){$this._trigger("success",$this,response)}else{$this._trigger("failed",$this,response)}
if(response.summary&&response.msg){var levelMsg=response.success===!1?'error':response.warning===!0?'warn':'info';znetdk.message(levelMsg,response.summary,response.msg)}}else if(typeof callback==="function"){callback(response)}}})}else{throw new Error('zdkinputfile: unable to upload file!')}},reset:function(){this.element.val('');this.currentFile=null;this.currentFileName='';this.currentFileType='';this.currentFileSize=0;this.selectedFileLabel.html(this.options.noFileLabel);this.thumbnail.attr('src',null);this.thumbnail.hide();this.removeFileButton.hide();this.uploadedFileInfos=null;this._trigger('reset')},setUploadedFile:function(fileInfos){if(fileInfos===undefined||fileInfos===null||typeof fileInfos!=='object'){return!1}else{this.uploadedFileInfos=fileInfos}
if(fileInfos.url!==undefined&&fileInfos.url.length>0&&fileInfos.mimeType!==undefined&&fileInfos.mimeType.length>0&&this.options.showThumbnail&&fileInfos.mimeType.indexOf("image/")===0){this.thumbnail.attr('src',fileInfos.url);this.thumbnail.show()}
if(fileInfos.url!==undefined&&fileInfos.url.length>0&&fileInfos.mimeType!==undefined&&fileInfos.mimeType.length>0&&fileInfos.mimeType.indexOf("image/")===-1){this.removeFileButton.show()}else if(fileInfos.filename!==undefined&&fileInfos.filename.length>0){this.selectedFileLabel.text(fileInfos.filename);this.removeFileButton.show()}
return!0},getUploadedFile:function(){return this.uploadedFileInfos},setFocus:function(){this.selectFileButton.focus()}})});$.widget("znetdk.zdkinputhtml",{_create:function(){var input=this.element,disabled=input.attr('data-disabled');input.addClass('pui-inputtext ui-widget ui-state-default ui-corner-all');if(disabled==='true'){input.addClass('ui-state-disabled');this.element.attr('contenteditable',!1)}else{this.element.attr('contenteditable',!0);this._enableMouseEffects()}
input.attr('role','textbox').attr('aria-disabled',disabled).attr('aria-multiline',!0)},_enableMouseEffects:function(){var input=this.element,$this=this;this.element.on('mouseenter.zdkinputhtml mouseleave.zdkinputhtml',function(){input.toggleClass('ui-state-hover')}).on('focus.zdkinputhtml',function(){input.addClass('ui-state-focus');$this.htmlContent=$this.getValue()}).on('blur.zdkinputhtml',function(){input.removeClass('ui-state-focus');if($this.htmlContent!==$this.getValue()){$this._trigger('change')}})},_disableMouseEffects:function(){var input=this.element;input.off("mouseenter.zdkinputhtml mouseleave.zdkinputhtml focus.zdkinputhtml blur.zdkinputhtml")},disable:function(){if(this.element.attr('data-disabled')==='false'||this.element.attr('data-disabled')===undefined){this.element.attr('data-disabled',!0);this.element.attr('aria-disabled',!0);this.element.attr('contenteditable',!1);this.element.addClass('ui-state-disabled');this.element.removeClass('ui-state-focus ui-state-hover');this._disableMouseEffects()}},enable:function(){if(this.element.attr('data-disabled')==='true'){this.element.attr('data-disabled',!1);this.element.attr('aria-disabled',!1);this.element.attr('contenteditable',!0);this.element.removeClass('ui-state-disabled');this._enableMouseEffects()}},getValue:function(){return this.element.html()},setValue:function(value){this.element.html(value)},empty:function(){this.element.empty()},isEmpty:function(){return this.element.text().length===0}});$(function(){$.widget("primeui.puiinputtext",$.primeui.puiinputtext,{_enableMouseEffects:function(){var input=this.element;input.on('mouseenter.puiinputtext mouseleave.puiinputtext',function(){input.toggleClass('ui-state-hover')}).on('focus.puiinputtext',function(){input.addClass('ui-state-focus')}).on('blur.puiinputtext',function(){input.removeClass('ui-state-focus')})},_disableMouseEffects:function(){var input=this.element;input.off("mouseenter.puiinputtext mouseleave.puiinputtext focus.puiinputtext blur.puiinputtext")},disable:function(){if(this.element.prop('disabled')===!1){this._super()}},enable:function(){if(this.element.prop('disabled')===!0){this._super()}}})});$(function(){$.widget("znetdk.zdklistbox",$.primeui.puilistbox,{options:{controller:null,action:null},_create:function(){this._super();this._setActionFromAttribute();this._loadData()},_loadData:function(selectedItemValues){if(this.options.controller&&this.options.action){var $this=this;znetdk.request({control:this.options.controller,action:this.options.action,callback:function(response){if(response.success===!0){$this._setOption('data',response.rows);$this.selectItemsByValues(selectedItemValues);$this._trigger('dataloaded')}else{znetdk.message('error',response.summary,response.msg)}}})}else{this.resetSelection()}},selectItemsByValues:function(selectedItemValues){this.unselectAll();if($.type(selectedItemValues)==="array"){for(i=0;i<selectedItemValues.length;++i){this.selectItemByValue(selectedItemValues[i])}}},getSelectedItemValues:function(){var selectedItems=new Array();this.choices.filter(':selected').each(function(){selectedItems.push($(this).attr('value'))});return selectedItems},refresh:function(keepSelection){if(keepSelection){var selectedItems=this.getSelectedItemValues();this._loadData(selectedItems)}else{this._loadData()}},getSelectedItemPositions:function(){var selectedItems=new Array();this.items.filter('.ui-state-highlight').each(function(){selectedItems.push($(this).index())});return selectedItems},selectItemsByPosition:function(selectedItems){this.unselectAll();if($.type(selectedItems)==="array"){for(i=0;i<selectedItems.length;++i){this.selectItem(selectedItems[i])}}},resetSelection:function(){var $this=this;this.unselectAll();this.choices.filter('[selected]').each(function(){$this.selectItemByValue($(this).val())})},selectItemByValue:function(value){var index=this.choices.filter(function(){return $(this).attr('value')===value}).index();if(index>-1){this.selectItem(index)}},_setActionFromAttribute:function(){var actionAttrib=znetdk.getActionFromAttr(this.element);if(actionAttrib!==!1){this.options.controller=actionAttrib.controller;this.options.action=actionAttrib.action}}})});$(function(){$.widget("znetdk.zdklogindialog",$.primeui.puidialog,{options:{loginName:null,changepwd:!1},_create:function(){this.element.data('icon','fa-unlock-alt');this.formCreated=!1;this.loginFormDisplayed=!0;this.loginForm=$('<form/>').appendTo(this.element);this.options.resizable=!1;this.options.showEffect='fade';this.options.hideEffect='fade';this.options.minimizable=!1;this.options.maximizable=!1;this.options.closable=!1;this.options.closeOnEscape=!1;this.options.modal=!0;this.options.width=380;this.options.visible=!0;this._super()},_createLoginForm:function(){this.element.find('.pui-dialog-title').text(this.labels.title);var formEntryTag='<div class="zdk-form-entry"/>';$('<label>'+this.labels.loginFieldLabel+'</label>').appendTo(this.loginForm);this.loginField=$('<input name="login_name" maxlength="50" type="text" autocomplete="username" value="" required data-errmess-required="'+this.labels.fieldMandatory+'">').appendTo(this.loginForm);this.passwordLabel=$('<label>'+this.labels.passwordFieldLabel+'</label>').appendTo(this.loginForm);this.passwordField=$('<input name="password" maxlength="20" type="password" autocomplete="current-password" value="" required data-errmess-required="'+this.labels.fieldMandatory+'">').appendTo(this.loginForm);var storedAccess=this._getStoredAccessMode();if(this.labels.selectAccess){this.formEntryAccess=$(formEntryTag).appendTo(this.loginForm);$('<label class="required">'+this.labels.accessLabel+'</label>').appendTo(this.formEntryAccess);var radioButtonGroup=$('<div class="zdk-radiobuttongroup" data-name="access"/>').appendTo(this.formEntryAccess);var publicRadioButton=$('<input type="radio" id="public-access" value="public">').appendTo(radioButtonGroup);radioButtonGroup.append('<label for="public-access">'+this.labels.publicAccessLabel+'</label>');radioButtonGroup.append('<br>');var privateRadioButton=$('<input type="radio" id="private-access" value="private">').appendTo(radioButtonGroup);radioButtonGroup.append('<label for="private-access">'+this.labels.privateAccessLabel+'</label>');if(storedAccess!==!1){this.labels.defaultAccess=storedAccess}
if(this.labels.defaultAccess==='public'){publicRadioButton.prop('checked',!0)}else if(this.labels.defaultAccess==='private'){privateRadioButton.prop('checked',!0)}}
this.formEntryNewPassword=$(formEntryTag).appendTo(this.loginForm).hide();$('<input name="login_password" maxlength="20" type="password" disabled autocomplete="off" data-errmess-required="'+this.labels.fieldMandatory+'">').appendTo(this.formEntryNewPassword);$('<label>'+this.labels.changePasswordNew+'</label>').prependTo(this.formEntryNewPassword);this.formEntryConfirmPassword=$(formEntryTag).appendTo(this.loginForm).hide();$('<input name="login_password2" maxlength="20" type="password" disabled autocomplete="off" data-errmess-required="'+this.labels.fieldMandatory+'">').appendTo(this.formEntryConfirmPassword);$('<label>'+this.labels.changePasswordConfirm+'</label>').prependTo(this.formEntryConfirmPassword);if(typeof(this.labels.forgotPasswordAnchor)==='string'&&storedAccess!==!1&&!znetdk.isMenuExists()&&(this.options.loginName===null||this.options.loginName==='')){this.forgotPwdAnchor=$('<div class="forgot-pwd"><a href="#">'+this.labels.forgotPasswordAnchor+'</a></div>').appendTo(this.loginForm)}
this.loginButton=$('<button class="zdk-bt-yes" type="submit">'+this.labels.loginButtonLabel+'</button>').appendTo(this.loginForm);this.cancelButton=$('<button class="zdk-bt-cancel" type="button">'+this.labels.cancelButtonLabel+'</button>').appendTo(this.loginForm);this.loginForm.zdkform({controller:'security',action:'login',msgsuccess:!1});this._bindLoginEvents()},show:function(){if(!this.formCreated){this.formCreated=!0;this._getLabels()}else{if(this.options.changepwd&&this.loginFormDisplayed)
this._showChangePasswordForm();else if(!this.options.changepwd&&!this.loginFormDisplayed)
this._showLoginForm();this._super()}},_getLabels:function(){var $this=this;znetdk.request({control:'security',action:'getLoginDialogLabels',callback:function(response){$this.labels=response;$this._createLoginForm();$this.show()}})},_bindLoginEvents:function(){var $this=this;this.cancelButton.on('click.zdklogindialog',function(e){if($this.options.changepwd){$this.hide()}else{znetdk.request({control:'security',action:'cancellogin',callback:function(response){$this._trigger('cancel',null,response)}})}
e.preventDefault()});this.loginForm.on("zdkformcomplete.zdklogindialog",function(event,response){var accessMode=$(this).zdkform('getInputValues','access');$this._storeAccessMode(accessMode[0]);$this._storeLoginNameInLocalStorage(accessMode[0]);if($this.loginFormDisplayed||!$this.options.changepwd){$this._trigger('success',null,response)}else{$this.hide()}});this.loginForm.on("zdkformfailed.zdklogindialog",function(event,response){if(response.newpasswordrequired){$this._showChangePasswordForm()}else{if(response.toomuchattempts){$this.loginButton.puibutton('disable')}
$this._trigger('failed',null,response)}});if(this.forgotPwdAnchor){this.forgotPwdAnchor.on('click.zdklogindialog','a',function(event){znetdk.showModalDialog('znetdk_forgot_password_dialog','forgotpassword',null,function(dialog){dialog.one('zdkmodalafterhide.zdklogindialog',function(){$this.cancelButton.trigger('click')})});event.preventDefault()})}
this.options.afterHide=function(){$this.loginForm.zdkform('reset')}},_applyFocus:function(){var loginName=this.options.loginName?this.options.loginName:this._getLoginNameFromLocalStorage();if(loginName.length>0){this.loginField.val(loginName);this.passwordField.focus()}else{this._super()}},_storeAccessMode:function(accessMode){znetdk.storeLocalSettings('zdklogindialog_access_mode',accessMode)},_getStoredAccessMode:function(){return znetdk.getLocalSettings('zdklogindialog_access_mode')},_showChangePasswordForm:function(){this.element.find('.pui-dialog-title').text(this.labels.changePasswordTitle);this.loginButton.find('.pui-button-text').text(this.labels.changePasswordButton);this.loginField.puiinputtext('disable');this.passwordLabel.text(this.labels.changePasswordOriginal);this.formEntryNewPassword.show();this.formEntryNewPassword.find(':input').prop('required',!0).puiinputtext('enable');this.formEntryConfirmPassword.show();this.formEntryConfirmPassword.find(':input').prop('required',!0).puiinputtext('enable');if(this.formEntryAccess){this.formEntryAccess.hide()}
if(this.forgotPwdAnchor){this.forgotPwdAnchor.hide()}
this.passwordField.val('');this.passwordField.focus();this.loginFormDisplayed=!1;this.loginForm.zdkform('option','msgsuccess',!0)},_showLoginForm:function(){this.element.find('.pui-dialog-title').text(this.labels.title);this.loginButton.find('.pui-button-text').text(this.labels.loginButtonLabel);this.loginField.puiinputtext('enable');this.passwordLabel.text(this.labels.passwordFieldLabel);this.formEntryNewPassword.find(':input').prop('required',!1).puiinputtext('disable');this.formEntryNewPassword.hide();this.formEntryConfirmPassword.find(':input').prop('required',!0).puiinputtext('disable');this.formEntryConfirmPassword.hide();if(this.formEntryAccess){this.formEntryAccess.show()}
if(this.forgotPwdAnchor){this.forgotPwdAnchor.show()}
this.passwordField.val('');this.passwordField.focus();this.loginFormDisplayed=!0;this.loginForm.zdkform('option','msgsuccess',!1)},_storeLoginNameInLocalStorage:function(accessMode){var loginName=accessMode==='public'?'':this.loginField.val();znetdk.storeLocalSettings('zdklogindialog_login_name',loginName)},_getLoginNameFromLocalStorage:function(){var value=znetdk.getLocalSettings('zdklogindialog_login_name');return value===!1?'':value}})});$.widget("znetdk.zdklogo",{_create:function(){if(!znetdk.isPageToBeReloaded())this._bindEvents()},_bindEvents:function(){this.element.on('click',function(event){event.preventDefault();znetdk.showMenuView()})},disable:function(){this.element.off('click')},enable:function(){this._create()}});$.widget("znetdk.zdklogout",{_create:function(){this._bindEvents()},_bindEvents:function(){this.element.click(function(event){znetdk.setFooterSticky(!0);znetdk.request({control:'security',action:'logout',callback:function(response){znetdk.showFinalMessage(response.msg)}});event.preventDefault()})}});$(function(){$.widget("primeui.puibasemenu",$.primeui.puibasemenu,{_create:function(){this._super();this.refreshFaIconColor()},refreshFaIconColor:function(){var faIcon=this.element.find("span.pui-menuitem-icon[class*='fa-']").first();if(faIcon.length){var style=faIcon.css('background-image'),color='#'+style.substr(style.indexOf('ui-icons_')+9,6),menuFaStyles=$('head > style.zdk-menufa');if(menuFaStyles.length===1){menuFaStyles.remove()}
$('head').append('<style class="zdk-menufa">.pui-menuitem .pui-icon {color:'+color+';} '+'.pui-menuitem .ui-state-hover .pui-icon {color:inherit;}</style>');this.element.find("span.pui-menuitem-icon[class*='fa-']").removeClass('ui-icon').addClass('pui-icon fa fa-fw')}
this.element.find("span.ui-icon-triangle-1-e").removeClass('ui-icon').addClass('fa fa-caret-right fa-lg')}})});$(function(){$.widget("znetdk.zdkmodal",$.primeui.puidialog,{options:{resizable:!1,showEffect:'fade',hideEffect:'fade',minimizable:!1,maximizable:!1,modal:!0,width:'auto',confirmationOnClose:null},_create:function(){if(this.element.hasClass('zdk-modal-maximizable')){this.options.maximizable=!0}
this._setWidthFromAttribute();this._setConfirmationFromAttribute();this._super()},_bindEvents:function(){this._super();var $this=this,cancelButton=this.element.find('button.zdk-bt-cancel, button.zdk-bt-no').first(),saveButton=this.element.find('button.zdk-bt-save, button.zdk-bt-yes').first(),formElement=this.element.find('form.zdk-form');cancelButton.click(function(){if(cancelButton.length&&cancelButton.hasClass('zdk-close-dialog')){$this._closeDialog()}});this.element.on('zdkmodalclose',function(event){if(cancelButton.length&&cancelButton.hasClass('zdk-close-dialog')){$this._closeDialog();return!1}});if(formElement.length&&saveButton.length&&saveButton.hasClass('zdk-close-dialog')){formElement.bind("zdkformcomplete",function(){var focusedButton=$this.element.find('.zdk-form button:submit:focus');if(focusedButton.length&&!focusedButton.hasClass('zdk-close-dialog')){return!1}
$this.hide()})}},_closeDialog:function(){if(this.options.confirmationOnClose===null){this.hide()}else{if(this._areFormsModified()){var closeButton=this.element.find('button.zdk-bt-cancel, button.zdk-bt-no').first(),confirmationDialogTitle=closeButton.attr('title'),$this=this;if(confirmationDialogTitle===undefined){confirmationDialogTitle=closeButton.text()}
znetdk.getUserConfirmation({title:confirmationDialogTitle,message:this.options.confirmationOnClose[0],yesLabel:this.options.confirmationOnClose[1],noLabel:this.options.confirmationOnClose[2],callback:function(confirmation){if(confirmation){$this.hide()}}})}else{this.hide()}}},_areFormsModified:function(){var formElement=this.element.find('form.zdk-form');if(formElement.length>0){var isFormModified=!1;formElement.each(function(){if($(this).zdkform('isFormModified')){isFormModified=!0;return!1}});return isFormModified}else{return!1}},_setWidthFromAttribute:function(){var widthAttrib=znetdk.getTextFromAttr(this.element,'data-zdk-width');if(widthAttrib!==!1){this.options.width=widthAttrib}},_setConfirmationFromAttribute:function(){var confirmationMsg=znetdk.getTextFromAttr(this.element,'data-zdk-confirm');if(confirmationMsg!==!1){this.options.confirmationOnClose=confirmationMsg.split(":")}},show:function(resetPosition){if(resetPosition===!0){this.positionInitialized=!1}
this._super();this._restoreMaximizedDisplay()},toggleMaximize:function(){this._super();if(this.maximized){this._setContentAutoHeight()}else{this.content.height(this.options.height);this.element.css('height','auto')}
znetdk.storeLocalSettings(this.maximizedStorageKey,this.maximized)},_restoreMaximizedDisplay:function(){if(!this.options.maximizable){return!1}
if(this.maximized===!0){this.content.scrollTop(0)}else if(this.maximized===!1){this.element.css('height','auto')}
if(typeof this.maximized!=='undefined'){return}
var storageKeyPrefix='zdkmodal_maximized_',isMaximized=!1;this.maximizedStorageKey=storageKeyPrefix+this.element.uniqueId().attr('id');isMaximized=znetdk.getLocalSettings(this.maximizedStorageKey);if(this.element.outerHeight(!0)>$(window).height()||isMaximized==='true'){this.toggleMaximize()}}})});$(function(){$.widget("znetdk.zdkmultiupload",{options:{controller:null,action:null,selectButtonLabel:'Browse...',selectButtonIcon:'ui-icon-document',selectButtonTooltip:null,inputNameAttribute:null,acceptedFiles:null,photoReductionPercent:100,minPhotoSizeForReduction:800},_create:function(){this._setOptionsFromAttributes();this.element.addClass('zdk-multiupload');this.selectFileButton=$('<button type="button">'+this.options.selectButtonLabel+'</button>').appendTo(this.element);if(this.options.selectButtonTooltip!==null){this.selectFileButton.attr('title',this.options.selectButtonTooltip)}
this.selectFileButton.puibutton({icon:this.options.selectButtonIcon});this.inputfileContainer=$('<div class="ui-helper-hidden-accessible"/>').appendTo(this.element);this.selectedfileContainer=$('<div class="zdk-multiupload-files"/>').appendTo(this.element);this._bindEvents()},_bindEvents:function(){var $this=this;this.selectFileButton.click(function(){$this._selectNewFile()})},_setOptionsFromAttributes:function(){var actionAttrib=znetdk.getActionFromAttr(this.element),selectButtonAttrib=znetdk.getTextFromAttr(this.element,'data-zdk-selbuttonlabel'),buttonIcon=znetdk.getTextFromAttr(this.element,'data-zdk-icon'),buttonTooltip=znetdk.getTextFromAttr(this.element,'title'),inputName=znetdk.getTextFromAttr(this.element,'data-name'),acceptedFiles=znetdk.getTextFromAttr(this.element,'data-zdk-accept'),photoReductPerc=znetdk.getTextFromAttr(this.element,'data-zdk-photoreductpercent'),minPhotoSizeForReduct=znetdk.getTextFromAttr(this.element,'data-zdk-minphotosizetoreduct');if(actionAttrib!==!1){this.options.controller=actionAttrib.controller;this.options.action=actionAttrib.action;this.element.removeAttr('data-zdk-action')}
if(selectButtonAttrib!==!1){this.options.selectButtonLabel=selectButtonAttrib;this.element.removeAttr('data-zdk-selbuttonlabel')}
if(buttonIcon!==!1){this.options.selectButtonIcon=buttonIcon;this.element.removeAttr('data-zdk-icon')}
if(buttonTooltip!==!1){this.options.selectButtonTooltip=buttonTooltip;this.element.removeAttr('title')}
if(inputName!==!1){this.options.inputNameAttribute=inputName}
if(acceptedFiles!==!1){this.options.acceptedFiles=acceptedFiles;this.element.removeAttr('data-zdk-accept')}
if(photoReductPerc!==!1){this.options.photoReductionPercent=parseInt(photoReductPerc)}
if(minPhotoSizeForReduct!==!1){this.options.minPhotoSizeForReduction=parseInt(minPhotoSizeForReduct)}},_checkAttributes:function(){if(this.options.controller===null||this.options.action===null){throw new Error('zdkmultiupload: the controller and action are not properly set!')}
if(this.options.inputNameAttribute===null){throw new Error('zdkmultiupload: the name for the file inputs is not set!')}},_isFileAlreadySelected:function(filename){var isAlreadySelected=!1;this.selectedfileContainer.find('.zdk-multiupload-filename').each(function(){if($(this).text()===filename){isAlreadySelected=!0;return!1}});return isAlreadySelected},_attachSelectfileEvents:function(inputfileElement){var $this=this;inputfileElement.one('zdkinputfileselect',function(evt,filename){if(!$this._isFileAlreadySelected(filename)){$this._displaySelectedFile(filename,$(this).attr('id'));$this._trigger('select',$this,filename)}})},_attachRemovefileEvents:function(selectedFileElement){var $this=this;selectedFileElement.find('.zdk-multiupload-remove-link').one('click',function(evt){$this._removeSelectedFile($(this).attr('href'));evt.preventDefault()})},_removeSelectedFile:function(inputfileId){var inputfileWidget=this.inputfileContainer.find('#'+inputfileId).parent(),selectedfileElement=this.selectedfileContainer.find('a[href='+inputfileId+']').parent(),nextFileSeparator=selectedfileElement.next('span'),prevFileSeparator=selectedfileElement.prev('span');inputfileWidget.remove();selectedfileElement.remove();if(nextFileSeparator.length){nextFileSeparator.remove()}else if(prevFileSeparator.length){prevFileSeparator.remove()}},_displaySelectedFile:function(filename,inputfileId){var fileElement=$('<div/>');if(this.selectedfileContainer.children().length){this.selectedfileContainer.append('<span>,&nbsp;</span>')}
fileElement.appendTo(this.selectedfileContainer);fileElement.append('<span class="zdk-multiupload-filename">'+filename+'</span>');if(inputfileId!==undefined){fileElement.append('<a class="zdk-multiupload-remove-link" href="'+inputfileId+'"><span class="fa fa-lg fa-remove"/></a>');this._attachRemovefileEvents(fileElement)}},_setSelectedFileAsLink:function(position,url){var fileContainer=this.selectedfileContainer.children('div').eq(position);if(fileContainer.length===0){return!1}
fileContainer.find('span.zdk-multiupload-filename').wrap('<a href="'+url+'" target="_blank"></a>');return!0},_selectNewFile:function(){this._checkAttributes();var newInputfile=$('<input type="file" name="'+this.options.inputNameAttribute+'[]" accept="'+this.options.acceptedFiles+'">');newInputfile.appendTo(this.inputfileContainer).zdkinputfile({controller:this.options.controller,action:this.options.action,showThumbnail:!1,noFileLabel:'',photoReductionPercent:this.options.photoReductionPercent,minPhotoSizeForReduction:this.options.minPhotoSizeForReduction});this._attachSelectfileEvents(newInputfile);newInputfile.click()},reset:function(){this.inputfileContainer.empty();this.selectedfileContainer.empty()},setFocus:function(){this.selectFileButton.focus()},setUploadedFiles:function(files){var $this=this,isOk=!0;if(!$.isArray(files)||files.length===0){return!1}
$.each(files,function(index,value){if(typeof value!=='object'){isOk=!1;return!1}
if(value.filename!==undefined&&value.filename.length>0){$this._displaySelectedFile(value.filename)}
if(value.url!==undefined&&value.url.length>0){$this._setSelectedFileAsLink(index,value.url)}});return isOk},disable:function(){this.selectFileButton.puibutton('disable')},enable:function(){this.selectFileButton.puibutton('enable')},isEmpty:function(){return this.selectedfileContainer.children().length===0}})});$.widget("znetdk.zdkofficemenu",{options:{winAutoClose:!0},_create:function(){this.openedWindowsCount=0;this.winContainer=$('#zdk-win-container');this.element.children('ul').puitieredmenu({autoDisplay:!1});this.element.find('ul a > span.fa').addClass('fa-lg');this.menuWidget=this.element.children('.pui-menu').first();var winMgrElement=this.element.children('.zdk-win-manager').first(),titleLabel=winMgrElement.attr('title'),autoCloseLabel=winMgrElement.children('span').first().text(),adjustHorizLabel=winMgrElement.children('span').eq(1).text(),adjustVerticLabel=winMgrElement.children('span').eq(2).text(),closeAllLabel=winMgrElement.children('span').last().text();winMgrElement.empty();winMgrElement.attr('title',null);var menu=$('<ul/>').appendTo(winMgrElement),dataIcon=this.options.winAutoClose?'fa-check':'ui-icon-blank';menu.append('<li><h3>'+titleLabel+'</h3></li>');this.autoCloseItem=$('<li><a data-icon="'+dataIcon+'">'+autoCloseLabel+'</a></li>').appendTo(menu);this.adjustHorizItem=$('<li><a data-icon="fa-ellipsis-h">'+adjustHorizLabel+'</a></li>').appendTo(menu);this.adjustVerticItem=$('<li><a data-icon="fa-ellipsis-v">'+adjustVerticLabel+'</a></li>').appendTo(menu);this.closeAllItem=$('<li><a data-icon="fa-times">'+closeAllLabel+'</a></li>').appendTo(menu);menu.puimenu();this._bindEvents();this._setOpenedWindowsCount(0)},_bindEvents:function(){var $this=this;this.autoCloseItem.children('a').click(function(){if($this.options.winAutoClose){$(this).attr('data-icon','ui-icon-blank');$(this).children('span').first().removeClass('fa-check');$(this).children('span').first().addClass('ui-icon-blank');$this.options.winAutoClose=!1}else{$(this).attr('data-icon','fa-check');$(this).children('span').first().removeClass('ui-icon-blank');$(this).children('span').first().addClass('fa-check');$this.options.winAutoClose=!0}});this.adjustHorizItem.children('a').click(function(){var frontWindows=$this._getFrontWindows();if(frontWindows.first.length===1&&frontWindows.second.length===1){$this._adjustWindows(frontWindows,!0)}});this.adjustVerticItem.children('a').click(function(){var frontWindows=$this._getFrontWindows();if(frontWindows.first.length===1&&frontWindows.second.length===1){$this._adjustWindows(frontWindows,!1)}});this.closeAllItem.children('a').click(function(){$this._closeAllWindows()});if(this.menuWidget.length===1){this.menuWidget.find('ul > li > a').click(function(event){if($(this).next('ul').length===0){var menuItemId=($(this).attr('href')).substr(1),menuItemLabel=$(this).children('span.ui-menuitem-text').text(),menuItemIcon=$(this).data('icon');$this._openWindow(menuItemId,menuItemLabel,menuItemIcon)}
event.preventDefault()})}},_openWindow:function(menuItemId,menuItemLabel,menuItemIcon,callParameter){var $this=this,dialogId='znetdk-'+menuItemId+'-view',dialogElement=$('#'+dialogId),dlgIsCreated=(dialogElement.length>0),dlgIsHidden=dlgIsCreated?dialogElement.puidialog('isHidden'):!0;if(dlgIsHidden&&this.options.winAutoClose===!0){this._closeAllWindows()}
if(dlgIsCreated){this._trigger('initview',this,{firstInit:!1,menuItem:menuItemId,dialog:dialogElement,value:callParameter});if(dlgIsHidden){dialogElement.puidialog('option','width','auto').puidialog('option','height','auto').puidialog('option','location','0,0')}
dialogElement.puidialog('show').puidialog('moveToTop')}else{dialogElement=$('<div id="'+dialogId+'" title="'+menuItemLabel+'" data-icon="'+menuItemIcon+'"/>');var winContainer=this._getWinContainer();znetdk.loadView({htmlTarget:dialogElement,control:menuItemId,action:"show",callback:function(){var isVisible=!0,synchronizedWidget=dialogElement.find('.zdk-synchronize'),isAutoHeight=dialogElement.find('.zdk-view-maxheight').length>0;if(synchronizedWidget.length===1&&synchronizedWidget.hasClass('zdk-datatable')){synchronizedWidget.one("zdkdatatabledataloaded",function(){dialogElement.puidialog('show')});isVisible=!1}else if(synchronizedWidget.length===1&&synchronizedWidget.hasClass('zdk-inputrows')){synchronizedWidget.one("zdkinputrowsinitialized",function(){dialogElement.puidialog('show')});isVisible=!1}
dialogElement.puidialog({location:'0,0',width:'auto',height:'auto',autoHeight:isAutoHeight,closeOnEscape:!1,appendTo:winContainer,visible:isVisible,showEffect:'fade',hideEffect:'fade',afterShow:function(){$this._reduceWindowWidth(dialogElement);znetdk.addLabelToTitle(menuItemLabel);$this._setOpenedWindowsCount(+1);$this._trigger('aftershowview',$this,{menuItem:menuItemId,dialog:dialogElement,value:callParameter})},afterHide:function(){znetdk.addLabelToTitle(null);$this._setOpenedWindowsCount(-1,menuItemLabel)}});dialogElement.on("puidialogmovedtotop",function(){znetdk.addLabelToTitle(menuItemLabel)});$this._trigger('initview',$this,{firstInit:!0,menuItem:menuItemId,dialog:dialogElement,value:callParameter})}})}},_getFrontWindows:function(){if(this.menuWidget.length===1){var firstZindex=0,secondZindex=0,currentZindex=0,winContainer=this._getWinContainer();winContainer.children('.pui-dialog[aria-hidden="false"]').each(function(){currentZindex=parseInt($(this).css('z-index'),10);if(currentZindex>firstZindex){secondZindex=firstZindex;firstZindex=currentZindex}else if(currentZindex>secondZindex){secondZindex=currentZindex}});if(firstZindex){var response=new Object();response.first=winContainer.children('.pui-dialog[style*="z-index: '+firstZindex+';"][aria-hidden="false"]').first();response.second=!1;if(secondZindex){response.second=winContainer.children('.pui-dialog[style*="z-index: '+secondZindex+';"][aria-hidden="false"]').first()}
return response}}
return!1},_getWinContainer:function(){return this.winContainer.length?this.winContainer:$('body')},_closeAllWindows:function(){var winContainer=this._getWinContainer();winContainer.children('.pui-dialog[aria-hidden="false"]').each(function(){$(this).puidialog('hide')})},_setOpenedWindowsCount:function(gap,menuItemLabel){this.openedWindowsCount+=gap;if(this.openedWindowsCount>1){this._enableButton(this.adjustHorizItem,!0);this._enableButton(this.adjustVerticItem,!0)}else if(this.openedWindowsCount>0){this._enableButton(this.adjustHorizItem,!1);this._enableButton(this.adjustVerticItem,!1);this._enableButton(this.closeAllItem,!0)}else{this._enableButton(this.adjustHorizItem,!1);this._enableButton(this.adjustVerticItem,!1);this._enableButton(this.closeAllItem,!1)}
if(this.openedWindowsCount>0&&gap===-1){var frontWindows=this._getFrontWindows(),windowTitle;if(frontWindows&&frontWindows.second.length===1&&!frontWindows.second.puidialog('isHidden')){windowTitle=frontWindows.second.puidialog('getTitle');if(menuItemLabel!==windowTitle){znetdk.addLabelToTitle(frontWindows.second.puidialog('getTitle'))}}
if(frontWindows&&frontWindows.first.length===1&&!frontWindows.first.puidialog('isHidden')){windowTitle=frontWindows.first.puidialog('getTitle');if(menuItemLabel!==windowTitle){znetdk.addLabelToTitle(frontWindows.first.puidialog('getTitle'))}}}},_enableButton:function(button,enabled){if(enabled){button.removeClass("ui-state-disabled").children('a').removeClass("ui-state-disabled")}else{button.addClass("ui-state-disabled").children('a').addClass("ui-state-disabled")}},_adjustWindows:function(frontWindows,horizontally){var winContainer=this._getWinContainer(),position=winContainer.offset(),winWidth=0,winHeight=0,firstLocation='',secondLocation='';if(horizontally){winWidth=winContainer.width()-5;winHeight=(winContainer.height()/2)-50;firstLocation='left,top';secondLocation=position.left+','+(position.top+(parseInt(winContainer.height()/2,10)))}else{winWidth=(winContainer.width()/2)-5;winHeight=winContainer.height()-50;firstLocation=position.left+','+(position.top+1);secondLocation=(position.left+winWidth+5)+','+(position.top+1)}
frontWindows.first.puidialog('option','width',winWidth);frontWindows.first.puidialog('option','height',winHeight);frontWindows.first.puidialog('option','location',firstLocation);frontWindows.second.puidialog('option','width',winWidth);frontWindows.second.puidialog('option','height',winHeight);frontWindows.second.puidialog('option','location',secondLocation)},_reduceWindowWidth:function(dialogElement){var winWidth=dialogElement.width(),winContainerWidth=this._getWinContainer().width();if(winContainerWidth<winWidth){dialogElement.puidialog('option','width',winContainerWidth)}},_getMenuItemId:function(element){return(element.attr('href')).substr(1)},_getFirstMenuItemId:function(){var firstItem=this.menuWidget.find('ul > li > a').first();if(firstItem.length){return this._getMenuItemId(firstItem)}else{return!1}},_getFirstChildMenuItemId:function(parent){if(parent===undefined){parent=this.menuWidget.find('ul > li').first()}
if(parent.length){var child=parent.find('ul>li').first();if(child.length){return this._getFirstChildMenuItemId(child)}else{var linkElement=parent.children('a').first();return this._getMenuItemId(linkElement)}}else{return!1}},openWindow:function(viewID,callParameter){if(this.menuWidget.length===1){var menuItemId=viewID===undefined?this._getFirstChildMenuItemId():viewID,menuItemLabel,menuItemIcon;menuItemLabel=this.menuWidget.find('ul > li > a[href="#'+menuItemId+'"] > span.ui-menuitem-text').text();menuItemIcon=this.menuWidget.find('ul > li > a[href="#'+menuItemId+'"]').data('icon');if(menuItemLabel){this._openWindow(menuItemId,menuItemLabel,menuItemIcon,callParameter)}}},closeWindow:function(viewID){if(this.menuWidget.length===1&&viewID!==undefined){var dialogId='znetdk-'+viewID+'-view',dialogElement=$('#'+dialogId);if(dialogElement.length){dialogElement.puidialog('hide')}}},setWindowTitle:function(viewID,title){if(this.menuWidget.length===1&&viewID!==undefined){var dialogId='znetdk-'+viewID+'-view',dialogElement=$('#'+dialogId);if(dialogElement.length){dialogElement.puidialog('setTitle',title)}}},getSelectedMenuItem:function(){var selectedMenu=null,frontWindows=this._getFrontWindows();if(frontWindows&&frontWindows.first.length===1){selectedMenu=new Object();var menuId=frontWindows.first.attr('id'),suffixPos=menuId.lastIndexOf('-view');selectedMenu.id=menuId.substring(7,suffixPos);selectedMenu.label=frontWindows.first.find('span.pui-dialog-title').text()}
return selectedMenu},refreshIconsColor:function(){this.menuWidget.children('ul').first().puitieredmenu('refreshFaIconColor')}});$(function(){$.widget("primeui.puipaginator",$.primeui.puipaginator,{refresh:function(){var newPageCount=this.getPageCount(),pageLinksElement=this.paginatorElements['{PageLinks}'].children(),oldPageCount=pageLinksElement.length;if(newPageCount!==oldPageCount){this.options.page=this.options.page<newPageCount?this.options.page:(newPageCount-1);this.element.empty();this.element.removeClass('pui-paginator ui-widget-header');this._create()}}})});$(function(){$.widget("znetdk.zdkpicklist",$.primeui.puipicklist,{options:{controller:null,action:null,criteria:null},_create:function(){this._setCaptionFromTitle();this._setActionFromAttribute();this._setFilterFromAttribute();this._super();this._replaceIcons();this._autoLoadFromAttribute()},_setCaptionFromTitle:function(){var sourceTitle=znetdk.getTextFromAttr(this.element.children('select').eq(0),'title'),targetTitle=znetdk.getTextFromAttr(this.element.children('select').eq(1),'title');if(sourceTitle){this.options.sourceCaption=sourceTitle}
if(targetTitle){this.options.targetCaption=targetTitle}},_setActionFromAttribute:function(){var actionAttrib=znetdk.getActionFromAttr(this.element);if(actionAttrib!==!1){this.options.controller=actionAttrib.controller;this.options.action=actionAttrib.action}},_setFilterFromAttribute:function(){var filter=znetdk.getTextFromAttr(this.element,'data-zdk-filter');if(filter==='true'){this.options.filter=!0;this.options.filterMatchMode='contains'}},_replaceIcons:function(){if(this.options.filter){var searchIcons=this.element.find('div.pui-picklist-filter-container > span.ui-icon');searchIcons.each(function(){$(this).removeClass('ui-icon ui-icon-search').addClass('fa fa-fw fa-search')})}
this.element.find('.pui-picklist-button-add > .pui-button-icon-left').removeClass('ui-icon-arrow-1-e ui-icon').addClass('pui-icon fa fa-fw fa-angle-right');this.element.find('.pui-picklist-button-addall > .pui-button-icon-left').removeClass('ui-icon-arrowstop-1-e ui-icon').addClass('pui-icon fa fa-fw fa-angle-double-right');this.element.find('.pui-picklist-button-remove > .pui-button-icon-left').removeClass('ui-icon-arrow-1-w ui-icon').addClass('pui-icon fa fa-fw fa-angle-left');this.element.find('.pui-picklist-button-removeall > .pui-button-icon-left').removeClass('ui-icon-arrowstop-1-w ui-icon').addClass('pui-icon fa fa-fw fa-angle-double-left')},_autoLoadFromAttribute:function(){var autoLoad=znetdk.getTextFromAttr(this.element,'data-zdk-autoload');if(autoLoad){this._loadData()}},_loadData:function(){if(this.options.controller&&this.options.action){var $this=this,request={control:this.options.controller,action:this.options.action,callback:function(response){$this._initLists(response);$this._trigger('dataloaded')}};if(this.options.criteria!==null){request.data=this.options.criteria}
znetdk.request(request)}},_initLists:function(rows){var sourceData=[],targetData=[];$.each(rows,function(index,row){if(row.isSelected){targetData.push(row)}else{sourceData.push(row)}});this._setOption('sourceData',sourceData);this._setOption('targetData',targetData)},refresh:function(criteria){if(typeof criteria!=='undefined'){this.options.criteria=criteria}
this._loadData()},reset:function(){this._loadData()},getSelection:function(){var options=this.targetInput.children('option'),selection=[],elementName=this.element.data('name')+'[]';if(elementName.length===0){return selection}
for(var i=0;i<options.length;i++){selection.push({name:elementName,value:$(options[i]).val()})}
return selection},_setOptionData:function(input,listContainer,data){this._unbindEvents();this._super(input,listContainer,data)}})});$(function(){var checkedRadios={};$.widget("primeui.puiradiobutton",$.primeui.puiradiobutton,{_create:function(){this.silent=!1;this._super();if(this.element.prop('checked')){checkedRadios[this.element.attr('name')]=this.box}},_bindEvents:function(){this._super();var $this=this;this.box.off('click.puiradiobutton');this.box.on('click.puiradiobutton',function(){if(!$this._isChecked()){$this.element.trigger('click')}});this.element.off('change');this.element.change(function(e){var name=$this.element.attr('name');if(checkedRadios[name]){checkedRadios[name].removeClass('ui-state-active ui-state-focus ui-state-hover').children('.pui-radiobutton-icon').removeClass('ui-icon ui-icon-bullet')}
$this.icon.addClass('ui-icon ui-icon-bullet');if(!$this.element.is(':focus')){$this.box.addClass('ui-state-active')}
checkedRadios[name]=$this.box;if($this.silent){$this.silent=!1}else{$this._trigger('selectionchange',null)}})},_unbindEvents:function(){this._super();if(this.label.length>0){this.element.off()}},enable:function(){this.element.prop('disabled',!1);this._super()},disable:function(){this._super();this.element.prop('disabled',!0)},select:function(value){if(!this.disabled&&!this._isChecked()&&this.element.val()===value){this.silent=!0;this.element.trigger('click')}},unselect:function(){if(!this.disabled&&this._isChecked()){this.box.removeClass('ui-state-active ui-state-focus ui-state-hover').children('.pui-radiobutton-icon').removeClass('ui-icon ui-icon-bullet');this.element.removeProp('checked');delete checkedRadios[this.element.attr('name')]}}})});$(function(){$.widget("znetdk.zdkradiobuttongroup",{options:{name:null},_create:function(){this._setNameFromAttribute();var $this=this,tableElement=null,currentRow=null;this.element.find(':radio').each(function(){var labelElement=$(this).next(),lineBreakElement=labelElement.next();$(this).uniqueId().attr('name',$this.options.name);if($(this).prop('checked')){$this.defaultValue=$(this).val()}
if(!labelElement.is('label')){labelElement=$('<label>no label!</label>').insertAfter($(this))}
labelElement.attr('for',$(this).attr('id'));$(this).wrap('<td/>');labelElement.wrap('<td/>');var elementsToWrap=$(this).parent().add(labelElement.parent());if(currentRow===null){elementsToWrap.wrapAll('<tr/>');currentRow=$(this).parent().parent()}else{elementsToWrap.appendTo(currentRow)}
if(tableElement===null){currentRow.wrap('<table/>');tableElement=currentRow.parent()}else{tableElement.append(currentRow)}
if(lineBreakElement.is('br')){currentRow=null;lineBreakElement.remove()}})},_setNameFromAttribute:function(){var nameAttrib=znetdk.getTextFromAttr(this.element,'data-name');if(nameAttrib!==!1){this.options.name=nameAttrib}},resetSelection:function(){this.element.find(':radio').each(function(){$(this).puiradiobutton('unselect');$(this).puiradiobutton('enable')});if(this.defaultValue!==undefined){var radioToSelect=this.element.find('[value="'+this.defaultValue+'"]');if(radioToSelect.length===1){radioToSelect.puiradiobutton('select',this.defaultValue)}}}})});$(function(){$.widget("primeui.puisticky",$.primeui.puisticky,{_create:function(){var element=this.element;var $this=this,win;var topPosition,topFixedPosition;if(this.options.scrollableParent.length){win=this.options.scrollableParent;topPosition=element.position().top;topFixedPosition=element.offset().top}else{win=$(window);topPosition=element.offset().top;topFixedPosition=0}
this.initialState={top:topPosition,topFixed:topFixedPosition,height:element.height()};win.on('scroll',function(){if(win.scrollTop()>$this.initialState.top){$this._fix()}else{$this._restore()}})},_getWidth:function(){if(this.options.autoWidth){return'auto'}else{return this.element.width()}},_fix:function(){if(!this.fixed){this.element.css({'position':'fixed','top':this.initialState.topFixed,'z-index':1000,'width':this.element.width()}).addClass('pui-shadow ui-sticky');$('<div class="ui-sticky-ghost"></div>').height(this.initialState.height).insertBefore(this.element);this.fixed=!0}},_restore:function(){if(this.fixed){this.element.css({'position':'static','top':'auto','width':this._getWidth()}).removeClass('pui-shadow ui-sticky');this.element.prev('.ui-sticky-ghost').remove();this.fixed=!1}}})});$.widget("znetdk.zdktabmenu",{options:{pageReload:!1},_create:function(){var $this=this;this.noLoadFirstLevel2Tab=!1;this.element.find('div.tab_panel').puipanel();this.element.puitabview({orientation:'left',activeIndex:this._getLevel1SelectedTab(),change:function(event,index){var menuId;var selectedTabNbr=isNaN(Number(index.index))?0:index.index;var selectedTab=$(this).children('.pui-tabview-panels').children('.pui-tabview-panel').eq(selectedTabNbr);if(!selectedTab.length){return}
if($this.options.pageReload){var tabLink=$(this).children('ul').children('li').eq(selectedTabNbr).children('a').first();location.assign(tabLink.attr('href'));return}
if(selectedTab.has('.zdk-classic-menu-level2').length){if($this.noLoadFirstLevel2Tab){$this.noLoadFirstLevel2Tab=!1}else{var L2selectedTabNbr=selectedTab.find('.zdk-classic-menu-level2').puitabview('getActiveIndex');L2selectedTabNbr=isNaN(Number(L2selectedTabNbr))?0:L2selectedTabNbr;selectedTab.find('.zdk-classic-menu-level2').puitabview('select',L2selectedTabNbr)}}else{menuId=selectedTab.attr('id');znetdk.addLabelToTitle($(this).children('ul').children('li').eq(selectedTabNbr).children('a').text());var controller=menuId.substr(5);znetdk.loadView({htmlTarget:selectedTab.find('.zdk-dynamic-content:empty'),control:controller,action:"show",callback:function(response){$.event.trigger({type:"L1menuViewLoad",index:selectedTabNbr,menuId:menuId})}})}
$.event.trigger({type:"L1menuTabChange",index:selectedTabNbr,menuId:menuId})}});this.element.find('.zdk-classic-menu-level2').puitabview({activeIndex:this._getLevel2SelectedTab(),contentOverflow:!0,change:function(event,index){var menuId;var selectedTabNbr=isNaN(Number(index.index))?0:index.index;if($this.options.pageReload){var tabLink=$(this).children('ul').children('li').eq(selectedTabNbr).children('a').first();location.assign(tabLink.attr('href'));return}
znetdk.addLabelToTitle($(this).children('ul').children('li').eq(selectedTabNbr).children('a').text());var selectedTab=$(this).find('.pui-tabview-panel:eq('+selectedTabNbr+')');menuId=selectedTab.attr('id');var controller=menuId.substr(5);znetdk.loadView({htmlTarget:selectedTab.find('.zdk-dynamic-content:empty'),control:controller,action:"show",callback:function(response){$.event.trigger({type:"L2menuViewLoad",index:selectedTabNbr,menuId:menuId})}});$.event.trigger({type:"L2menuTabChange",index:selectedTabNbr,menuId:menuId})}})},getSelectedTab:function(){var selectedMenu=null,menuElement=this.element,selectedTabNbr=menuElement.puitabview('getActiveIndex');selectedTabNbr=isNaN(Number(selectedTabNbr))?0:selectedTabNbr;var selectedTab=menuElement.children('.pui-tabview-panels').children('.pui-tabview-panel').eq(selectedTabNbr);if(selectedTab.has('.zdk-classic-menu-level2').length){menuElement=selectedTab.find('.zdk-classic-menu-level2');selectedTabNbr=menuElement.puitabview('getActiveIndex');selectedTabNbr=isNaN(Number(selectedTabNbr))?0:selectedTabNbr;selectedTab=menuElement.find('.pui-tabview-panel').eq(selectedTabNbr)}
selectedMenu=new Object();var menuId=selectedTab.attr('id');selectedMenu.id=menuId.substr(5);selectedMenu.label=menuElement.children('ul').children('li').eq(selectedTabNbr).children('a').text();return selectedMenu},selectTab:function(viewName){var menuItem=this.element.find('#menu-'+viewName);if(menuItem.length){var level2Parent=menuItem.parents(".zdk-classic-menu-level2");if(level2Parent.length){if(!this.options.pageReload){this.noLoadFirstLevel2Tab=!0;this.element.puitabview('select',level2Parent.parent().index())}
level2Parent.puitabview('select',menuItem.index())}else{this.element.puitabview('select',menuItem.index())}}else{this.element.puitabview('select',0)}},_getLevel1SelectedTab:function(){if(this.options.pageReload){var L1tabWithContent=this.element.find('div > div[id]:has(div.zdk-filled)');return L1tabWithContent.length?L1tabWithContent.index():0}else return 0},_getLevel2SelectedTab:function(){if(this.options.pageReload){var L2tabWithContent=this.element.find('.zdk-classic-menu-level2 > div > div[id]:has(div.zdk-filled)');return L2tabWithContent.length?L2tabWithContent.index():0}else return 0}});$(function(){$.widget("primeui.puitabview",$.primeui.puitabview,{removeAll:function(){var header,panel;var tabCount=this.getLength();for(i=0;i<tabCount;i++){header=this.navContainer.children().eq(0);panel=this.panelContainer.children().eq(0);this._trigger('close',null,0);header.remove();panel.remove()}},select:function(index){this._super(index);if(this.options.contentOverflow){this._resizeContent()}},_create:function(){this._super();if(this.options.allDisabled){this.navContainer.children().addClass('ui-state-disabled')}
if(this.options.contentOverflow){this._resizeContent()}
if(this.options.activeIndex){this.options.selected=this.options.activeIndex}},_resizeContent:function(){var navContainerHeight=this.navContainer.outerHeight(!0);var tabViewHeight=this.panelContainer.parent().height();this.panelContainer.css({'height':tabViewHeight-navContainerHeight-3})},enableFromList:function(idList){var menuItemSelector;for(var i in idList){menuItemSelector='a[href="#'+idList[i]+'"]';this.navContainer.children().find(menuItemSelector).parent().removeClass('ui-state-disabled')}},_bindEvents:function(){this._super();if(this.options.contentOverflow){var $this=this;$(window).bind('resize.zdk'+$this.uuid,function(){$this._resizeContent()})}}})});$(function(){$.widget("znetdk.zdktree",$.primeui.puitree,{options:{controller:null,action:null,autoSelectFamily:!1},_create:function(){this.element.addClass('zdk-tree');if(this.options.controller&&this.options.action){this.options.nodes=function(ui,response){var $this=this;znetdk.request({control:$this.options.controller,action:$this.options.action,callback:function(data){response.call($this,data.treenodes);$this._trigger('dataloaded')}})}}
this._super()},selectNode:function(node,noChildren){this._super(node);if(this.options.autoSelectFamily){var parentNode=this._getParentNode(node);if(parentNode!==null&&this._isNodeSelected(parentNode.data('puidata'))===!1){this.selectNode(parentNode,!0)}
var childNodes=this._getChildNodes(node);if(childNodes!==null&&!noChildren){var $this=this;childNodes.each(function(){if($this._isNodeSelected($(this).data('puidata'))===!1){$this.selectNode($(this))}})}}},getSelection:function(){var selectedNodes=new Array();var elementName=this.element.attr("data-name");for(var i=0;i<this.selection.length;i++){var node={name:elementName,value:this.selection[i]};selectedNodes.push(node)}
return selectedNodes},selectNodes:function(treeNodes){if($.type(treeNodes)==='array'){var $this=this;var treeNodesToSelect=treeNodes;this.element.find('.pui-treenode').each(function(){var nodeData=$(this).data('puidata');var dataIndex=treeNodesToSelect.indexOf(nodeData);if(dataIndex!==-1){$this.selectNode($(this),!0)}})}else{throw 'Unsupported type. treeNodes parameter must be an array'}},_getParentNode:function(node){var parentNode=node.parent().parent();if(parentNode.hasClass('pui-treenode-parent')){return parentNode}else{return null}},_getChildNodes:function(node){if(node.hasClass('pui-treenode-parent')){return node.children('ul.pui-treenode-children').children('li.pui-treenode')}else{return null}}})});$.widget("znetdk.zdkuserpanel",{_create:function(){var username=this.element.attr('data-zdk-username'),mail=this.element.attr('data-zdk-usermail'),pwdlabel=this.element.attr('data-zdk-changepwd'),userRightslabel=this.element.attr('data-zdk-myuserrights');if(username.length){this.menu=$('<ul id="zdk-profile-view"/>').appendTo('body');this.menu.append('<li class="username">'+username+'</li>');this.menu.append('<li class="usermail">'+mail+'</li>');this.menu.append('<li class="changepwd"><a class="ui-state-default"><i class="fa fa-unlock-alt"></i>&nbsp;&nbsp;'+pwdlabel+'</a></li>');this.menu.append('<li class="my-user-rights"><a class="ui-state-default"><i class="fa fa-key"></i>&nbsp;&nbsp;'+userRightslabel+'</a></li>');this.menu.puimenu({popup:!0,trigger:$('#zdk-profile')});$('#zdk-profile-view').parent('div.pui-menu-dynamic').addClass('zdk-user-panel');this._bindEvents()}},_bindEvents:function(){this.menu.find('li.changepwd').on('click.zdkuserpanel',function(){znetdk.showLoginDialog(!0)});this.menu.find('li.my-user-rights').on('click.zdkuserpanel',function(){znetdk.showModalDialog('znetdk_my_user_rights_dialog','myuserrights')})}});$(function(){$('#zdk-messages').puigrowl({life:5000});$('#zdk-critical-err').puinotify({easing:'easeInOutCirc'});$("#zdk-logout").zdklogout();$("#zdk-header-logo").zdklogo();$('#zdk-connection-area').zdkuserpanel();$('#zdk-help-area').zdkhelp();$('#zdk-ajax-loading-img').zdkajaxloader();znetdk.initLanguageSelect();znetdk.initNavigationMenu();znetdk.setFooterSticky();znetdk.registerServiceWorker();if(znetdk.isAuthenticationRequired()){znetdk.showLoginDialog()}else{$('.zdk-filled').each(function(){znetdk.autoInitWidgets($(this))});if(!znetdk.isPageToBeReloaded()){znetdk.showMenuView()}else{znetdk.goToPageAnchor()}}})